<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-bn="à¦¦à¦¾à¦°à§à¦¨à§à¦¨à¦¾à¦œà¦¾à¦¤ à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦›à¦¾à¦¤à§à¦° à¦«à§‹à¦°à¦¾à¦®" data-en="Darunnazat Alumni Forum Association">Darunnazat Alumni Forum Association</title>
    
    <!-- ===== CORRECTED FAVICON CONFIGURATION ===== -->
    <link rel="apple-touch-icon" sizes="180x180" href="/favicon_io/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon_io/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon_io/favicon-16x16.png">
    <link rel="icon" type="image/x-icon" href="/favicon_io/favicon.ico">
    <link rel="manifest" href="/favicon_io/site.webmanifest">
    
    <!-- Additional meta tags for better mobile display -->
    <meta name="theme-color" content="#2c5f2d">
    <meta name="msapplication-TileColor" content="#2c5f2d">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kalpurush&family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    
    <!-- Rest of your CSS and JavaScript -->
    <!-- ===== STYLES ===== -->
    <style>
        /* Core Styles */
        .gradient-bg {
            background: linear-gradient(135deg, #2c5f2d 0%, #1a3c1b 100%);
        }
        
        .mobile-menu {
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1000;
            background: white;
            overflow-y: auto;
        }
        
        .mobile-menu.active {
            transform: translateX(0);
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }
        
        .modal.active {
            display: flex;
        }
        
        .user-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #97bc62;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            overflow: hidden;
        }
        
        .user-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .dashboard-nav {
            background: linear-gradient(135deg, #2c5f2d 0%, #1a3c1b 100%);
        }
        
        .active-dashboard-tab {
            background-color: #97bc62;
            color: white;
        }
        
        .bangla-text {
            font-family: 'Kalpurush', 'Hind Siliguri', 'sans-serif';
        }
        
        /* Modern Hero Font - Raleway */
        .hero-title {
            font-family: 'Raleway', sans-serif;
            font-weight: 700;
            letter-spacing: 0.02em;
            line-height: 1.3;
        }
        
        .hero-subtitle {
            font-family: 'Raleway', sans-serif;
            font-weight: 400;
            letter-spacing: 0.03em;
            line-height: 1.7;
        }
        
        /* Mobile responsive font sizes */
        @media (max-width: 768px) {
            .hero-title {
                font-size: 2rem !important;
                letter-spacing: 0.03em;
                line-height: 1.2;
            }
            
            .hero-subtitle {
                font-size: 1rem !important;
                letter-spacing: 0.02em;
                line-height: 1.5;
            }
        }
        
        .close-mobile-menu {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 1001;
        }
        
        .hover-lift {
            transition: all 0.3s ease;
        }
        
        .hover-lift:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        
        .announcement-card {
            border-left: 4px solid #e67e22;
        }
        
        html {
            scroll-behavior: smooth;
        }
        
        /* Notification System */
        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 15px;
            border-radius: 5px;
            color: white;
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transition: opacity 0.3s ease;
            max-width: 70%;
            text-align: center;
            font-size: 14px;  /* Add this line (default is 16px) */

        }
        
        .notification.show {
            opacity: 1;
        }
        
        .notification.success {
            background-color: #2c5f2d;
        }
        
        .notification.error {
            background-color: #e53e3e;
        }
        
        .notification.info {
            background-color: #3182ce;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Component Styles */
        .profile-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #97bc62;
        }
        
        .member-modal-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid #97bc62;
        }
        
        .event-card {
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }
        
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .event-date {
            background: linear-gradient(135deg, #e67e22 0%, #d35400 100%);
        }
        
        .member-card {
            transition: all 0.3s ease;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
        }
        
        .member-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }
        
        .contact-info-card {
            background: linear-gradient(135deg, #2c5f2d 0%, #1a3c1b 100%);
            border-radius: 15px;
        }
        
        .announcement-card-new {
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
            border-left: 5px solid #e67e22;
            transition: all 0.3s ease;
        }
        
        .announcement-card-new:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.12);
        }
        
        /* Admin Panel Styles */
        .admin-table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .admin-table th, .admin-table td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .admin-table th {
            background-color: #f8fafc;
            font-weight: 600;
        }
        
        .batch-filter-btn {
            transition: all 0.3s ease;
        }
        
        .batch-filter-btn.active {
            background-color: #2c5f2d !important;
            color: white !important;
        }

        .lang-btn.active {
            background-color: #2c5f2d;
            color: white;
        }

        .status-pending {
            background-color: #fbbf24;
            color: white;
        }

        .status-confirmed {
            background-color: #10b981;
            color: white;
        }

        .status-rejected {
            background-color: #ef4444;
            color: white;
        }
        
        /* Welcome Modal */
        .welcome-modal {
            z-index: 1001;
        }
        
        .welcome-content {
            background: linear-gradient(135deg, #2c5f2d 0%, #1a3c1b 100%);
            color: white;
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            max-width: 500px;
            width: 90%;
        }
        
        .featured-member {
            border: 3px solid #e67e22;
            box-shadow: 0 10px 30px rgba(230, 126, 34, 0.3);
        }
        
        /* Gallery Styles */
        .gallery-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .gallery-item {
            position: relative;
            overflow: hidden;
            border-radius: 10px;
            cursor: pointer;
            aspect-ratio: 1;
        }
        
        .gallery-item img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.3s ease;
        }
        
        .gallery-item:hover img {
            transform: scale(1.05);
        }
        
        .gallery-modal {
            z-index: 1002;
        }
        
        .gallery-modal-content {
            max-width: 90%;
            max-height: 90%;
            position: relative;
        }
        
        .gallery-modal img {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
        }
        
        .gallery-nav {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1;
        }
        
        .gallery-nav.prev {
            left: 20px;
        }
        
        .gallery-nav.next {
            right: 20px;
        }
        
        .gallery-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.5);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 1;
        }
        
        .gallery-counter {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0,0,0,0.5);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 14px;
        }
        
        .event-gallery-section {
            margin-top: 40px;
            padding-top: 40px;
            border-top: 1px solid #e2e8f0;
        }
        
        .event-selector {
            margin-bottom: 20px;
        }
        
        .event-gallery-button {
            background-color: #2c5f2d;
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            margin: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        
        .event-gallery-button.active {
            background-color: #e67e22;
        }
        
        .event-gallery-button:hover {
            background-color: #1a3c1b;
        }
        
        /* Admin Panel Mobile Styles */
        .admin-card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .admin-card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .admin-card-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: #2c5f2d;
        }
        
        .admin-card-content {
            overflow-x: auto;
        }
        
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 20px;
        }
        
        .admin-item {
            background: #f8fafc;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #e2e8f0;
            min-width: 0;
        }
        
        .admin-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
            flex-wrap: nowrap;
        }
        
        .admin-item-title {
            font-weight: 600;
            color: #2c5f2d;
            flex: 1;
            min-width: 0;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        
        .admin-item-actions {
            display: flex;
            gap: 5px;
            flex-shrink: 0;
        }
        
        .admin-btn {
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            cursor: pointer;
            border: none;
        }
        
        .admin-btn-primary {
            background-color: #2c5f2d;
            color: white;
        }
        
        .admin-btn-danger {
            background-color: #ef4444;
            color: white;
        }
        
        .admin-btn-warning {
            background-color: #f59e0b;
            color: white;
        }
        
        .admin-btn-success {
            background-color: #10b981;
            color: white;
        }
        
        /* Responsive Styles */
        @media (max-width: 768px) {
            .admin-table {
                display: block;
                overflow-x: auto;
            }
            
            .admin-table th, .admin-table td {
                white-space: nowrap;
                min-width: 120px;
            }
            
            .contact-form-container {
                padding: 1rem !important;
            }
            
            .contact-info-card {
                margin-bottom: 1rem;
            }
            
            .admin-grid {
                grid-template-columns: 1fr;
            }
            
            .admin-item-header {
                flex-wrap: wrap;
            }
            
            .admin-action-buttons {
                flex-wrap: wrap;
            }
            
            .admin-card-content {
                overflow-x: visible;
            }
        }

        /* ===== NEW UI IMPROVEMENTS ===== */
        
        /* Button improvements */
        .btn-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-icon-only {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .btn-icon-only:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .btn-sm {
            padding: 8px 16px;
            font-size: 0.875rem;
        }
        
        /* Mobile navigation improvements */
        .mobile-nav-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .mobile-nav-item:hover {
            background-color: #f0f7f4;
        }
        
        /* Admin panel improvements */
        .admin-action-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: nowrap;
            flex-shrink: 0;
        }
        
        .admin-action-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            border-radius: 6px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .admin-action-btn:hover {
            transform: translateY(-2px);
        }
        
        .admin-action-btn.primary {
            background-color: #2c5f2d;
            color: white;
        }
        
        .admin-action-btn.danger {
            background-color: #ef4444;
            color: white;
        }
        
        .admin-action-btn.warning {
            background-color: #f59e0b;
            color: white;
        }
        
        .admin-action-btn.success {
            background-color: #10b981;
            color: white;
        }
        
        .admin-action-btn.info {
            background-color: #3b82f6;
            color: white;
        }
        
        /* Dashboard improvements */
        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 0;
        }
        
        .dashboard-tabs {
            display: flex;
            overflow-x: auto;
            gap: 4px;
            padding-bottom: 8px;
        }
        
        .dashboard-tab {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 12px 16px;
            border-radius: 8px;
            transition: all 0.3s ease;
            white-space: nowrap;
        }
        
        /* Gallery management improvements */
        .gallery-management-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        /* Back button improvements */
        .back-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            border-radius: 8px;
            background-color: #6b7280;
            color: white;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background-color: #4b5563;
            transform: translateY(-2px);
        }
        
        /* Mobile responsive improvements */
        @media (max-width: 640px) {
            .btn-text {
                display: none;
            }
            
            .btn-icon-only {
                width: 44px;
                height: 44px;
            }
            
            .admin-action-buttons {
                gap: 6px;
            }
            
            .admin-action-btn {
                width: 32px;
                height: 32px;
            }
            
            .dashboard-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
            
            .dashboard-tabs {
                width: 100%;
                justify-content: space-between;
            }
            
            .dashboard-tab {
                flex: 1;
                justify-content: center;
            }
            
            .gallery-management-header {
                flex-direction: column;
                gap: 16px;
                align-items: flex-start;
            }
        }
        
        /* Form improvements */
        .form-actions {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }
        
        /* Card improvements */
        .card {
            background: white;
            border-radius: 12px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .card:hover {
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .card-header {
            padding: 20px;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .card-body {
            padding: 20px;
        }
        
        /* Table improvements */
        .table-responsive {
            overflow-x: auto;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
        }
        
        .table th, .table td {
            padding: 12px 16px;
            text-align: left;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .table th {
            background-color: #f8fafc;
            font-weight: 600;
            color: #2c5f2d;
        }
        
        /* Stats improvements */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 24px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        /* ===== FLOATING LANGUAGE SWITCHER STYLES ===== */
.language-switcher-floating {
    animation: float 3s ease-in-out infinite;
    border: 2px solid #f0f7f4;
}

.language-switcher-floating:hover {
    animation: none;
    transform: scale(1.05);
}

.lang-btn {
    transition: all 0.3s ease;
    border: 2px solid transparent;
    font-weight: 600;
}

.lang-btn.active {
    border-color: #1a3c1b;
    transform: scale(1.1);
}

.lang-btn:not(.active):hover {
    transform: translateY(-2px);
}

@keyframes float {
    0%, 100% { 
        transform: translateY(0px) rotate(0deg); 
    }
    50% { 
        transform: translateY(-8px) rotate(2deg); 
    }
}

/* Mobile responsiveness */
@media (max-width: 768px) {
    .language-switcher-floating {
        bottom: 80px;
        right: 20px;
        transform: scale(0.9);
    }
    
    .language-switcher-floating:hover {
        transform: scale(0.95);
    }
}


/* Mobile click tooltip */
.admin-action-btn.show-tooltip::before {
    content: attr(title);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    font-size: 12px;
    margin-bottom: 5px;
    z-index: 1000;
    pointer-events: none;
}

.admin-action-btn.show-tooltip::after {
    content: '';
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 4px solid transparent;
    border-top-color: rgba(0, 0, 0, 0.9);
    margin-bottom: 1px;
}


/* Desktop click tooltip */
.admin-action-btn {
    position: relative;
}

.admin-action-btn:hover::after {
    content: attr(title);
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%);
    background: rgba(0, 0, 0, 0.9);
    color: white;
    padding: 4px 8px;
    border-radius: 4px;
    white-space: nowrap;
    font-size: 12px;
    margin-bottom: 5px;
    z-index: 1000;
}




/* Ensure it doesn't interfere with other elements */
.fixed.z-50 {
    z-index: 1000;
}

/* SUPER SIMPLE SCROLL ANIMATION */
section {
    opacity: 0;
    transform: translateY(50px);
    transition: all 0.8s ease-out;
}

section.visible {
    opacity: 1;
    transform: translateY(0);
}






    </style>
    
    <!-- Tailwind Config -->
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#2c5f2d',
                        secondary: '#97bc62',
                        accent: '#e67e22',
                        light: '#f0f7f4',
                        dark: '#1a3c1b',
                    },
                    fontFamily: {
                        'bangla': ['Kalpurush', 'Hind Siliguri', 'sans-serif'],
                        'hind': ['Hind Siliguri', 'sans-serif'],
                    }
                }
            }
        }
    </script>
</head>

<body class="font-hind bg-gray-50" data-lang="en">
    <!-- ===== NOTIFICATION SYSTEM ===== -->
    <div id="notification" class="notification">
        <i class="fas fa-check-circle"></i>
        <span id="notification-message">Operation completed successfully</span>
    </div>

    <!-- ===== WELCOME MODAL ===== -->
    <div id="welcome-modal" class="modal welcome-modal">
        <div class="welcome-content">
            <div class="text-5xl mb-4">ðŸŽ‰</div>
            <h2 id="welcome-title" class="text-3xl font-bold mb-4">Welcome to Our Alumni Community!</h2>
            <p id="welcome-message" class="text-lg mb-6">We're excited to have you join our growing network of alumni. Connect with batchmates, stay updated with events, and be part of our vibrant community.</p>
            <button id="close-welcome" class="bg-accent hover:bg-orange-600 text-white font-medium py-3 px-8 rounded-lg transition">
                Get Started
            </button>
        </div>
    </div>

    <!-- ===== GALLERY MODAL ===== -->
    <div id="gallery-modal" class="modal gallery-modal">
        <div class="gallery-modal-content bg-white rounded-lg overflow-hidden relative">
            <button class="gallery-close">
                <i class="fas fa-times"></i>
            </button>
            <button class="gallery-nav prev">
                <i class="fas fa-chevron-left"></i>
            </button>
            <button class="gallery-nav next">
                <i class="fas fa-chevron-right"></i>
            </button>
            <div class="gallery-counter">1 / 9</div>
            <img id="gallery-modal-image" src="" alt="Gallery Image">
        </div>
    </div>

    <!-- ===== NAVIGATION ===== -->
    <nav class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center space-x-3">
 <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center overflow-hidden">
    <img src="/favicon_io/android-chrome-192x192.png" alt="Site Logo" class="w-12 h-12 object-cover">
</div>
                    <div>
                        <h1 class="text-xl font-bold text-primary bangla-text" data-bn="à¦¦à¦¾à¦°à§à¦¨à§à¦¨à¦¾à¦œà¦¾à¦¤ à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦›à¦¾à¦¤à§à¦° à¦«à§‹à¦°à¦¾à¦®" data-en="Darunnazat ALumni Forum">Darunnazat ALumni Forum</h1>
                        <p class="text-xs text-gray-600 bangla-text" data-bn="à¦¦à¦¾à¦–à¦¿à¦² - 20 à¦†à¦²à¦¿à¦® - 22" data-en="Dakhil - 20 Alim - 22">Dakhil - 20 Alim - 22</p>
                    </div>
                </div>
                
                <div class="hidden md:flex space-x-8 items-center">
                   
                    
                    <a href="#home" class="text-primary font-medium hover:text-accent transition duration-300 nav-link" data-bn="à¦¹à§‹à¦®" data-en="Home">Home</a>
                    <a href="#about" class="text-gray-700 font-medium hover:text-accent transition duration-300 nav-link" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡" data-en="About Us">About Us</a>
                    <a href="#members" class="text-gray-700 font-medium hover:text-accent transition duration-300 nav-link" data-bn="à¦¸à¦¦à¦¸à§à¦¯à¦¬à§ƒà¦¨à§à¦¦" data-en="Members">Members</a>
                    <a href="#events" class="text-gray-700 font-medium hover:text-accent transition duration-300 nav-link" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Events">Events</a>
                    <a href="#gallery" class="text-gray-700 font-medium hover:text-accent transition duration-300 nav-link" data-bn="à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿" data-en="Gallery">Gallery</a>
                    <a href="#announcements" class="text-gray-700 font-medium hover:text-accent transition duration-300 nav-link" data-bn="à¦˜à§‹à¦·à¦£à¦¾" data-en="Announcements">Announcements</a>
                    
                    <div id="user-section" class="hidden">
                        <div class="flex items-center space-x-4">
                            <div class="user-avatar cursor-pointer" id="user-avatar">
                                <!-- Profile photo will be inserted here -->
                            </div>
                            <button id="dashboard-btn" class="bg-accent hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition btn-icon">
                                <i class="fas fa-user"></i>
                                <span id="user-name-display" class="btn-text" data-bn="à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦²" data-en="Profile">Profile</span>
                            </button>
                            <button id="logout-btn" class="bg-secondary hover:bg-green-600 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦²à¦—à¦†à¦‰à¦Ÿ" data-en="Logout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span class="btn-text">Logout</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="admin-section" class="hidden">
                        <div class="flex items-center space-x-4">
                            <button id="admin-panel-btn" class="bg-dark hover:bg-gray-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦…à§à¦¯à¦¾à¦¡à¦®à¦¿à¦¨ à¦ªà§à¦¯à¦¾à¦¨à§‡à¦²" data-en="Admin Panel">
                                <i class="fas fa-cogs"></i>
                                <span class="btn-text">Admin Panel</span>
                            </button>
                            <button id="admin-logout-btn" class="bg-secondary hover:bg-green-600 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦²à¦—à¦†à¦‰à¦Ÿ" data-en="Logout">
                                <i class="fas fa-sign-out-alt"></i>
                                <span class="btn-text">Logout</span>
                            </button>
                        </div>
                    </div>
                    
                    <div id="auth-buttons" class="flex space-x-2">
                        <button id="login-btn" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦²à¦—à¦‡à¦¨" data-en="Login">
                            <i class="fas fa-sign-in-alt"></i>
                            <span class="btn-text">Login</span>
                        </button>
                        <button id="register-btn" class="bg-accent hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦°" data-en="Register">
                            <i class="fas fa-user-plus"></i>
                            <span class="btn-text">Register</span>
                        </button>
                        <button id="admin-login-btn" class="bg-dark hover:bg-gray-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦…à§à¦¯à¦¾à¦¡à¦®à¦¿à¦¨" data-en="Admin">
                            <i class="fas fa-user-shield"></i>
                            <span class="btn-text">Admin</span>
                        </button>
                    </div>
                </div>
                
                <button id="mobile-menu-button" class="md:hidden text-gray-700">
                    <i class="fas fa-bars text-xl"></i>
                </button>
            </div>
        </div>
    </nav>

    <!-- ===== MOBILE MENU ===== -->
    <div id="mobile-menu" class="mobile-menu">
        <button class="close-mobile-menu text-gray-700 text-2xl">
            <i class="fas fa-times"></i>
        </button>
        <div class="pt-16 px-6">
            <div class="flex flex-col space-y-4">
               
                
                <a href="#home" class="mobile-nav-item text-primary font-medium nav-link" data-bn="à¦¹à§‹à¦®" data-en="Home" data-close-menu>
                    <i class="fas fa-home w-5"></i>
                    <span>Home</span>
                </a>
                <a href="#about" class="mobile-nav-item text-gray-700 font-medium nav-link" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡" data-en="About Us" data-close-menu>
                    <i class="fas fa-info-circle w-5"></i>
                    <span>About Us</span>
                </a>
                <a href="#members" class="mobile-nav-item text-gray-700 font-medium nav-link" data-bn="à¦¸à¦¦à¦¸à§à¦¯à¦¬à§ƒà¦¨à§à¦¦" data-en="Members" data-close-menu>
                    <i class="fas fa-users w-5"></i>
                    <span>Members</span>
                </a>
                <a href="#events" class="mobile-nav-item text-gray-700 font-medium nav-link" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Events" data-close-menu>
                    <i class="fas fa-calendar-alt w-5"></i>
                    <span>Events</span>
                </a>
                <a href="#gallery" class="mobile-nav-item text-gray-700 font-medium nav-link" data-bn="à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿" data-en="Gallery" data-close-menu>
                    <i class="fas fa-images w-5"></i>
                    <span>Gallery</span>
                </a>
                <a href="#announcements" class="mobile-nav-item text-gray-700 font-medium nav-link" data-bn="à¦˜à§‹à¦·à¦£à¦¾" data-en="Announcements" data-close-menu>
                    <i class="fas fa-bullhorn w-5"></i>
                    <span>Announcements</span>
                </a>
                
                <div id="mobile-user-section" class="hidden pt-6 border-t border-gray-200">
                    <div class="flex items-center space-x-4 mb-4">
                        <div class="user-avatar cursor-pointer" id="mobile-user-avatar">
                            <!-- Profile photo will be inserted here -->
                        </div>
                        <span id="mobile-user-name" class="font-medium"></span>
                    </div>
                    <button id="mobile-dashboard-btn" class="mobile-nav-item bg-accent hover:bg-orange-600 text-white w-full mb-3" data-close-menu>
                        <i class="fas fa-user w-5"></i>
                        <span id="mobile-user-name-display" data-bn="à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦²" data-en="Profile">Profile</span>
                    </button>
                    <button id="mobile-logout-btn" class="mobile-nav-item bg-secondary hover:bg-green-600 text-white w-full" data-bn="à¦²à¦—à¦†à¦‰à¦Ÿ" data-en="Logout" data-close-menu>
                        <i class="fas fa-sign-out-alt w-5"></i>
                        <span>Logout</span>
                    </button>
                </div>
                
                <div id="mobile-admin-section" class="hidden pt-6 border-t border-gray-200">
                    <button id="mobile-admin-panel-btn" class="mobile-nav-item bg-dark hover:bg-gray-800 text-white w-full mb-3" data-bn="à¦…à§à¦¯à¦¾à¦¡à¦®à¦¿à¦¨ à¦ªà§à¦¯à¦¾à¦¨à§‡à¦²" data-en="Admin Panel" data-close-menu>
                        <i class="fas fa-cogs w-5"></i>
                        <span>Admin Panel</span>
                    </button>
                    <button id="mobile-admin-logout-btn" class="mobile-nav-item bg-secondary hover:bg-green-600 text-white w-full" data-bn="à¦²à¦—à¦†à¦‰à¦Ÿ" data-en="Logout" data-close-menu>
                        <i class="fas fa-sign-out-alt w-5"></i>
                        <span>Logout</span>
                    </button>
                </div>
                
                <div id="mobile-auth-buttons" class="pt-6 border-t border-gray-200">
                    <button id="mobile-login-btn" class="mobile-nav-item bg-primary hover:bg-green-800 text-white w-full mb-3" data-bn="à¦²à¦—à¦‡à¦¨" data-en="Login" data-close-menu>
                        <i class="fas fa-sign-in-alt w-5"></i>
                        <span>Login</span>
                    </button>
                    <button id="mobile-register-btn" class="mobile-nav-item bg-accent hover:bg-orange-600 text-white w-full mb-3" data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦°" data-en="Register" data-close-menu>
                        <i class="fas fa-user-plus w-5"></i>
                        <span>Register</span>
                    </button>
                    <button id="mobile-admin-login-btn" class="mobile-nav-item bg-dark hover:bg-gray-800 text-white w-full" data-bn="à¦…à§à¦¯à¦¾à¦¡à¦®à¦¿à¦¨" data-en="Admin" data-close-menu>
                        <i class="fas fa-user-shield w-5"></i>
                        <span>Admin</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- ===== MAIN CONTENT ===== -->
    <div id="main-content">
        <!-- Hero Section -->
        <section id="home" class="relative h-screen flex items-center justify-center overflow-hidden">
            <div class="absolute inset-0">
                <img src="images/1763409997801-11wi2p26rrx.webp" 
                     alt="Madrasah Campus" class="w-full h-full object-cover">
                <div class="absolute inset-0 bg-primary opacity-80"></div>
            </div>
            
            <div class="container mx-auto px-4 relative z-10 text-center text-white">
                <h1 class="text-4xl md:text-6xl hero-title mb-6" data-bn="à¦¦à¦¾à¦°à§à¦¨à¦¨à¦¾à¦œà¦¾à¦¤ à¦¸à¦¿à¦¦à§à¦¦à¦¿à¦•à¦¿à¦¯à¦¼à¦¾ à¦•à¦¾à¦®à¦¿à¦² à¦®à¦¾à¦¦à§à¦°à¦¾à¦¸à¦¾" data-en="Darunnazat Siddikia Kamil Madrasah">Darunnazat Siddikia Kamil Madrasah</h1>
                <p class="text-xl md:text-2xl hero-subtitle mb-8 max-w-3xl mx-auto" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦¬à§à¦¯à¦¾à¦šà¦®à§‡à¦Ÿà¦¦à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦ªà§à¦¨à¦°à¦¾à¦¯à¦¼ à¦¸à¦‚à¦¯à§‹à¦— à¦¸à§à¦¥à¦¾à¦ªà¦¨ à¦•à¦°à§à¦¨, à¦¸à§à¦®à§ƒà¦¤à¦¿ à¦­à¦¾à¦— à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦¥à¦¾à¦•à§à¦¨" data-en="Reconnect with your batchmates, share memories and stay updated with alumni events">Reconnect with your batchmates, share memories and stay updated with alumni events</p>
                <div class="flex flex-wrap justify-center gap-4">
                    <a href="#members" class="bg-accent hover:bg-orange-600 text-white font-medium py-3 px-6 rounded-lg transition duration-300 transform hover:-translate-y-1 btn-icon" data-bn="à¦¬à§à¦¯à¦¾à¦šà¦®à§‡à¦Ÿ à¦–à§à¦à¦œà§à¦¨" data-en="Find Batchmates">
                        <i class="fas fa-users"></i>
                        <span>Find Batchmates</span>
                    </a>
                    <a href="#events" class="bg-secondary hover:bg-green-600 text-white font-medium py-3 px-6 rounded-lg transition duration-300 transform hover:-translate-y-1 btn-icon" data-bn="à¦†à¦¸à¦¨à§à¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Upcoming Events">
                        <i class="fas fa-calendar-alt"></i>
                        <span>Upcoming Events</span>
                    </a>
                    <button id="hero-register-btn" class="bg-white hover:bg-gray-100 text-primary font-medium py-3 px-6 rounded-lg transition duration-300 transform hover:-translate-y-1 btn-icon" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à¦®à¦¿à¦‰à¦¨à¦¿à¦Ÿà¦¿à¦¤à§‡ à¦¯à§‹à¦— à¦¦à¦¿à¦¨" data-en="Join Our Community">
                        <i class="fas fa-user-plus"></i>
                        <span>Join Our Community</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Stats Section -->
        <section class="py-16 bg-white">
            <div class="container mx-auto px-4">
                <div class="stats-grid">
                    <div class="stat-card bg-gradient-to-r from-primary to-dark text-white hover-lift">
                        <div class="text-5xl font-bold mb-2" id="total-members">0</div>
                        <div class="text-xl bangla-text" data-bn="à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€" data-en="Alumni Members">Alumni Members</div>
                    </div>
                    <div class="stat-card bg-gradient-to-r from-accent to-orange-600 text-white hover-lift">
                        <div class="text-5xl font-bold mb-2" id="total-batches">0</div>
                        <div class="text-xl bangla-text" data-bn="à¦¬à§à¦¯à¦¾à¦š" data-en="Batches">Batches</div>
                    </div>
                    <div class="stat-card bg-gradient-to-r from-secondary to-green-600 text-white hover-lift">
                        <div class="text-5xl font-bold mb-2" id="total-years">25+</div>
                        <div class="text-xl bangla-text" data-bn="à¦¸à¦®à§à¦ªà§à¦°à¦¦à¦¾à¦¯à¦¼à§‡à¦° à¦¬à¦›à¦°" data-en="Years of Community">Years of Community</div>
                    </div>
                </div>
            </div>
        </section>

        <!-- About Us Section -->
        <section id="about" class="py-16 bg-light">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-primary mb-4 bangla-text" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡" data-en="About Us">About Us</h2>
                <div class="w-20 h-1 bg-accent mx-auto mb-12"></div>
                
                <div class="flex flex-col md:flex-row items-center gap-12">
                    <div class="md:w-1/2">
                        <img src="images/0001_3_a-professional-circular-logo-design-for-_vrqPOmDSTmaN7hsA6dQu3g_Z7yc1AYaQsyGMK9qzRBi6g.jpeg" alt="Madrasah Building" class="w-full h-auto max-h-64 md:max-h-80 lg:max-h-96 object-contain">
                    </div>
                    <div class="md:w-1/2">
                        <h3 class="text-2xl font-bold text-primary mb-4 bangla-text" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦®à¦¿à¦¶à¦¨" data-en="Our Mission">Our Mission</h3>
                        <p class="text-gray-700 mb-6 bangla-text" data-bn="à¦¦à¦¾à¦°à§à¦¨à¦¨à¦¾à¦œà¦¾à¦¤ à¦¸à¦¿à¦¦à§à¦¦à¦¿à¦•à¦¿à¦¯à¦¼à¦¾ à¦•à¦¾à¦®à¦¿à¦² à¦®à¦¾à¦¦à§à¦°à¦¾à¦¸à¦¾à¦° à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€à¦¦à§‡à¦° à¦®à¦§à§à¦¯à§‡ à¦†à¦œà§€à¦¬à¦¨ à¦¸à¦‚à¦¯à§‹à¦— à¦—à¦¡à¦¼à§‡ à¦¤à§‹à¦²à¦¾, à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€à¦¦à§‡à¦° à¦¸à¦¹à¦¾à¦¯à¦¼à¦¤à¦¾ à¦•à¦°à¦¾ à¦à¦¬à¦‚ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦®à§à¦®à¦¿à¦²à¦¿à¦¤ à¦à¦¤à¦¿à¦¹à§à¦¯ à¦“ à¦®à§‚à¦²à§à¦¯à¦¬à§‹à¦§ à¦‰à¦¦à¦¯à¦¾à¦ªà¦¨ à¦•à¦°à¦¾à¥¤" data-en="To build lifelong connections among Darunnazat Siddikia Kamil Madrasah alumni, support current students, and celebrate our collective heritage and values.">To build lifelong connections among Darunnazat Siddikia Kamil Madrasah alumni, support current students, and celebrate our collective heritage and values.</p>
                        
                        <h3 class="text-2xl font-bold text-primary mb-4 bangla-text" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦­à¦¿à¦¶à¦¨" data-en="Our Vision">Our Vision</h3>
                        <p class="text-gray-700 mb-6 bangla-text" data-bn="à§¨à§¦à§¦à§« à¦¸à¦¾à¦²à§‡ à¦ªà§à¦°à¦¤à¦¿à¦·à§à¦ à¦¿à¦¤, à¦†à¦®à¦¾à¦¦à§‡à¦° à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦à¦¸à§‹à¦¸à¦¿à¦¯à¦¼à§‡à¦¶à¦¨ à¦¶à¦¤ à¦¶à¦¤ à¦¸à¦¦à¦¸à§à¦¯ à¦¨à¦¿à¦¯à¦¼à§‡ à¦¬à§‡à¦¡à¦¼à§‡ à¦‰à¦ à§‡à¦›à§‡à¥¤ à¦†à¦®à¦°à¦¾ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à¦®à¦¿à¦‰à¦¨à¦¿à¦Ÿà¦¿ à¦¶à¦•à§à¦¤à¦¿à¦¶à¦¾à¦²à§€ à¦°à¦¾à¦–à¦¤à§‡ à¦ªà§à¦¨à¦°à§à¦®à¦¿à¦²à¦¨à§€, à¦•à¦®à¦¿à¦‰à¦¨à¦¿à¦Ÿà¦¿ à¦¸à¦¾à¦°à§à¦­à¦¿à¦¸ à¦ªà§à¦°à¦•à¦²à§à¦ª à¦à¦¬à¦‚ à¦¨à§‡à¦Ÿà¦“à¦¯à¦¼à¦¾à¦°à§à¦•à¦¿à¦‚ à¦‡à¦­à§‡à¦¨à§à¦Ÿà§‡à¦° à¦†à¦¯à¦¼à§‹à¦œà¦¨ à¦•à¦°à¦¿à¥¤" data-en="Established in 2005, our alumni association has grown with hundreds of members. We organize reunions, community service projects, and networking events to keep our community strong.">Established in 2005, our alumni association has grown with hundreds of members. We organize reunions, community service projects, and networking events to keep our community strong.</p>
                        
                        <div class="flex space-x-4">
                            <div class="bg-primary text-white p-4 rounded-lg text-center flex-1 hover-lift">
                                <i class="fas fa-users text-2xl mb-2"></i>
                                <h4 class="font-bold bangla-text" data-bn="à¦•à¦®à¦¿à¦‰à¦¨à¦¿à¦Ÿà¦¿" data-en="Community">Community</h4>
                            </div>
                            <div class="bg-accent text-white p-4 rounded-lg text-center flex-1 hover-lift">
                                <i class="fas fa-hand-holding-heart text-2xl mb-2"></i>
                                <h4 class="font-bold bangla-text" data-bn="à¦¸à¦¹à¦¾à¦¯à¦¼à¦¤à¦¾" data-en="Support">Support</h4>
                            </div>
                            <div class="bg-secondary text-white p-4 rounded-lg text-center flex-1 hover-lift">
                                <i class="fas fa-graduation-cap text-2xl mb-2"></i>
                                <h4 class="font-bold bangla-text" data-bn="à¦¶à¦¿à¦•à§à¦·à¦¾" data-en="Education">Education</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Members Section -->
        <section id="members" class="py-16 bg-white">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-primary mb-4 bangla-text" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦¦à¦¸à§à¦¯à¦¬à§ƒà¦¨à§à¦¦" data-en="Our Members">Our Members</h2>
                <div class="w-20 h-1 bg-accent mx-auto mb-8"></div>
                
                <!-- Search and Filter -->
                <div class="flex flex-col md:flex-row justify-between items-center mb-8 gap-4">
                    <div class="w-full md:w-1/3">
                        <div class="relative">
                            <input type="text" id="member-search" class="w-full px-4 py-3 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary bangla-text" placeholder="Search members..." data-bn="à¦¸à¦¦à¦¸à§à¦¯ à¦–à§à¦à¦œà§à¦¨..." data-en="Search members...">
                            <i class="fas fa-search absolute left-3 top-3.5 text-gray-400"></i>
                        </div>
                    </div>
                    <div class="flex flex-wrap gap-2">
                        <button class="batch-filter-btn bg-primary text-white px-4 py-2 rounded-lg active" data-batch="all" data-bn="à¦¸à¦•à¦²" data-en="All">All</button>
                        <button class="batch-filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg" data-batch="20" data-bn="à§¨à§¦ à¦¬à§à¦¯à¦¾à¦š" data-en="20 Batch">20 Batch</button>
                        <button class="batch-filter-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg" data-batch="22" data-bn="à§¨à§¨ à¦¬à§à¦¯à¦¾à¦š" data-en="22 Batch">22 Batch</button>
                    </div>
                </div>
                
                <!-- Members Grid -->
                <div id="members-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                    <!-- Members will be loaded from database -->
                </div>
                
                <!-- Loading State -->
                <div id="members-loading" class="text-center py-8">
                    <div class="loading mx-auto mb-4"></div>
                    <p class="text-gray-600 bangla-text" data-bn="à¦¸à¦¦à¦¸à§à¦¯ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡..." data-en="Loading members...">Loading members...</p>
                </div>
                
                <!-- View More Button -->
                <div class="text-center mt-8">
                    <button id="view-more-members" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition bangla-text btn-icon" data-bn="à¦†à¦°à¦“ à¦¸à¦¦à¦¸à§à¦¯ à¦¦à§‡à¦–à§à¦¨" data-en="View More Members">
                        <i class="fas fa-eye"></i>
                        <span>View More Members</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Announcements Section -->
        <section id="announcements" class="py-16 bg-light">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-primary mb-4 bangla-text" data-bn="à¦¸à¦¾à¦®à§à¦ªà§à¦°à¦¤à¦¿à¦• à¦˜à§‹à¦·à¦£à¦¾" data-en="Recent Announcements">Recent Announcements</h2>
                <div class="w-20 h-1 bg-accent mx-auto mb-8"></div>
                
                <div id="announcements-container" class="max-w-4xl mx-auto space-y-6">
                    <!-- Announcements will be loaded from database -->
                </div>
                
                <!-- Loading State -->
                <div id="announcements-loading" class="text-center py-8">
                    <div class="loading mx-auto mb-4"></div>
                    <p class="text-gray-600 bangla-text" data-bn="à¦˜à§‹à¦·à¦£à¦¾ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡..." data-en="Loading announcements...">Loading announcements...</p>
                </div>
            </div>
        </section>

      <!-- Events Section -->
<section id="events" class="py-16 bg-white">
    <div class="container mx-auto px-4">
        <h2 class="text-3xl md:text-4xl font-bold text-center text-primary mb-4 bangla-text" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦“ à¦ªà§à¦¨à¦°à§à¦®à¦¿à¦²à¦¨à§€" data-en="Events & Reunions">Events & Reunions</h2>
        <div class="w-20 h-1 bg-accent mx-auto mb-8"></div>
        
        <!-- This is the container that needs the CSS -->
        <div id="events-container" class="max-w-4xl mx-auto space-y-6">
            <!-- Events will be loaded from database -->
        </div>
        
        <!-- Loading State -->
        <div id="events-loading" class="text-center py-8">
            <div class="loading mx-auto mb-4"></div>
            <p class="text-gray-600 bangla-text" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡..." data-en="Loading events...">Loading events...</p>
        </div>
    </div>
</section>

        <!-- Gallery Section -->
        <section id="gallery" class="py-16 bg-light">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-primary mb-4 bangla-text" data-bn="à¦«à¦Ÿà§‹ à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿" data-en="Photo Gallery">Photo Gallery</h2>
                <div class="w-20 h-1 bg-accent mx-auto mb-8"></div>
                
                <div class="event-selector mb-6">
                    <div id="gallery-buttons" class="flex flex-wrap justify-center">
                        <!-- Gallery buttons will be loaded here -->
                    </div>
                </div>
                
                <div id="gallery-container" class="gallery-container">
                    <!-- Gallery images will be loaded here -->
                </div>
                
                <div id="gallery-loading" class="text-center py-8">
                    <div class="loading mx-auto mb-4"></div>
                    <p class="text-gray-600 bangla-text" data-bn="à¦›à¦¬à¦¿ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡..." data-en="Loading images...">Loading images...</p>
                </div>
                
                <div id="no-gallery-message" class="text-center py-8 hidden">
                    <p class="text-gray-600 bangla-text" data-bn="à¦à¦‡ à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿à¦° à¦œà¦¨à§à¦¯ à¦•à§‹à¦¨ à¦›à¦¬à¦¿ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿" data-en="No images found for this gallery">No images found for this gallery</p>
                </div>
                
                <div id="view-all-container" class="text-center mt-8 hidden">
                    <button id="view-all-photos" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition bangla-text btn-icon" data-bn="à¦¸à¦®à¦¸à§à¦¤ à¦›à¦¬à¦¿ à¦¦à§‡à¦–à§à¦¨" data-en="View All Photos">
                        <i class="fas fa-images"></i>
                        <span>View All Photos</span>
                    </button>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="py-16 bg-gray-50">
            <div class="container mx-auto px-4">
                <h2 class="text-3xl md:text-4xl font-bold text-center text-primary mb-4 bangla-text" data-bn="à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦•à¦°à§à¦¨" data-en="Contact Us">Contact Us</h2>
                <div class="w-20 h-1 bg-accent mx-auto mb-12"></div>
                
                <div class="max-w-4xl mx-auto contact-form-container">
                    <div class="card">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8 p-8">
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-6 bangla-text" data-bn="à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦•à¦°à§à¦¨" data-en="Get In Touch">Get In Touch</h3>
                                
                                <div class="space-y-4">
                                    <div class="flex items-center space-x-4 p-4 bg-light rounded-lg">
                                        <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center">
                                            <i class="fas fa-map-marker-alt text-white"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold bangla-text" data-bn="à¦ à¦¿à¦•à¦¾à¦¨à¦¾" data-en="Address">Address</h4>
                                            <p class="text-gray-600 text-sm bangla-text" data-bn="à¦ªà§‚à¦°à§à¦¬ à¦¬à¦°à§à¦¨à¦¨à¦—à¦°, à¦¸à¦¾à¦°à§à¦²à¦¿à¦¯à¦¼à¦¾, à¦¡à§‡à¦®à¦°à¦¾, à¦¢à¦¾à¦•à¦¾ â€“ à§§à§©à§¬à§§" data-en="East Barunnagar, Sarulia, Demra, Dhaka â€“ 1361">East Barunnagar, Sarulia, Demra, Dhaka â€“ 1361</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center space-x-4 p-4 bg-light rounded-lg">
                                        <div class="w-12 h-12 bg-accent rounded-full flex items-center justify-center">
                                            <i class="fas fa-phone text-white"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold bangla-text" data-bn="à¦«à§‹à¦¨" data-en="Phone">Phone</h4>
                                            <p class="text-gray-600">+à§®à§®à§¦ à§¯à§¬à§© à§®à§«à§§ à§¦à§¯à§§à§¬</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex items-center space-x-4 p-4 bg-light rounded-lg">
                                        <div class="w-12 h-12 bg-secondary rounded-full flex items-center justify-center">
                                            <i class="fas fa-envelope text-white"></i>
                                        </div>
                                        <div>
                                            <h4 class="font-bold bangla-text" data-bn="à¦‡à¦®à§‡à¦‡à¦²" data-en="Email">Email</h4>
                                            <p class="text-gray-600">alumni.dskmaa2025@gmail.com</p>
                                        </div>
                                    </div>
                                    
                                    <div class="flex justify-center space-x-4 pt-4">
                                        <a href="#" class="w-12 h-12 bg-blue-600 hover:bg-blue-700 text-white rounded-full flex items-center justify-center transition">
                                            <i class="fab fa-facebook-f"></i>
                                        </a>
                                        <a href="#" class="w-12 h-12 bg-green-500 hover:bg-green-600 text-white rounded-full flex items-center justify-center transition">
                                            <i class="fab fa-whatsapp"></i>
                                        </a>
                                        <a href="#" class="w-12 h-12 bg-pink-600 hover:bg-pink-700 text-white rounded-full flex items-center justify-center transition">
                                            <i class="fab fa-instagram"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h3 class="text-2xl font-bold text-primary mb-6 bangla-text" data-bn="à¦¬à¦¾à¦°à§à¦¤à¦¾ à¦ªà¦¾à¦ à¦¾à¦¨" data-en="Send Message">Send Message</h3>
                                
                                <form id="contact-form" class="space-y-4">
                                    <div>
                                        <label for="contact-name" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦¨à¦¾à¦®" data-en="Your Name">Your Name</label>
                                        <input type="text" id="contact-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                    </div>
                                    <div>
                                        <label for="contact-email" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦‡à¦®à§‡à¦‡à¦²" data-en="Email">Email</label>
                                        <input type="email" id="contact-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                    </div>
                                    <div>
                                        <label for="contact-batch" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¬à§à¦¯à¦¾à¦š" data-en="Batch">Batch</label>
                                        <input type="text" id="contact-batch" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                    </div>
                                    <div>
                                        <label for="contact-message" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¬à¦¾à¦°à§à¦¤à¦¾" data-en="Message">Message</label>
                                        <textarea id="contact-message" rows="4" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                                    </div>
                                    <button type="submit" class="w-full bg-primary hover:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition duration-300 bangla-text btn-icon" data-bn="à¦¬à¦¾à¦°à§à¦¤à¦¾ à¦ªà¦¾à¦ à¦¾à¦¨" data-en="Send Message">
                                        <i class="fas fa-paper-plane"></i>
                                        <span>Send Message</span>
                                    </button>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- ===== FOOTER ===== -->
    <footer class="bg-dark text-white py-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <div class="flex items-center mb-4">
                        <div class="w-12 h-12 bg-primary rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-graduation-cap text-white text-xl"></i>
                        </div>
                        <div>
                            <h3 class="text-xl font-bold bangla-text" data-bn="à¦¦à¦¾à¦°à§à¦¨à¦¨à¦¾à¦œà¦¾à¦¤ à¦¸à¦¿à¦¦à§à¦¦à¦¿à¦•à¦¿à¦¯à¦¼à¦¾ à¦•à¦¾à¦®à¦¿à¦² à¦®à¦¾à¦¦à§à¦°à¦¾à¦¸à¦¾" data-en="Darunnazat Siddikia Kamil Madrasah">Darunnazat Siddikia Kamil Madrasah</h3>
                            <p class="text-gray-400 bangla-text" data-bn="à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦à¦¸à§‹à¦¸à¦¿à¦¯à¦¼à§‡à¦¶à¦¨" data-en="Alumni Association">Alumni Association</p>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-4 bangla-text" data-bn="à¦¦à§à¦°à§à¦¤ à¦²à¦¿à¦‚à¦•" data-en="Quick Links">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="#home" class="text-gray-400 hover:text-white transition nav-link" data-bn="à¦¹à§‹à¦®" data-en="Home">Home</a></li>
                        <li><a href="#members" class="text-gray-400 hover:text-white transition nav-link" data-bn="à¦¸à¦¦à¦¸à§à¦¯à¦¬à§ƒà¦¨à§à¦¦" data-en="Members">Members</a></li>
                        <li><a href="#events" class="text-gray-400 hover:text-white transition nav-link" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Events">Events</a></li>
                        <li><a href="#gallery" class="text-gray-400 hover:text-white transition nav-link" data-bn="à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿" data-en="Gallery">Gallery</a></li>
                        <li><a href="#announcements" class="text-gray-400 hover:text-white transition nav-link" data-bn="à¦˜à§‹à¦·à¦£à¦¾" data-en="Announcements">Announcements</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold mb-4 bangla-text" data-bn="à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦—" data-en="Contact">Contact</h4>
                    <ul class="space-y-2 text-gray-400">
                        <li class="flex items-start">
                            <i class="fas fa-map-marker-alt mt-1 mr-2 text-accent"></i>
                            <span class="bangla-text" data-bn="Darunnazat Siddikia Kamil Madrasah Alumni Association<br>à¦ªà§‚à¦°à§à¦¬ à¦¬à¦°à§à¦¨à¦¨à¦—à¦°, à¦¸à¦¾à¦°à§à¦²à¦¿à¦¯à¦¼à¦¾, à¦¡à§‡à¦®à¦°à¦¾, à¦¢à¦¾à¦•à¦¾ â€“ à§§à§©à§¬à§§" data-en="Darunnazat Siddikia Kamil Madrasah Alumni Association<br>East Barunnagar, Sarulia, Demra, Dhaka â€“ 1361">Darunnazat Siddikia Kamil Madrasah Alumni Association<br>East Barunnagar, Sarulia, Demra, Dhaka â€“ 1361</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-envelope mr-2 text-accent"></i>
                            <span>alumni.dskmaa2025@gmail.com</span>
                        </li>
                        <li class="flex items-center">
                            <i class="fas fa-phone mr-2 text-accent"></i>
                            <span>+à§®à§®à§¦ à§¯à§¬à§© à§®à§«à§§ à§¦à§¯à§§à§¬</span>
                        </li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-gray-700 mt-8 pt-8 text-center text-gray-400">
                <p class="bangla-text" data-bn="&copy; à§¨à§¦à§¨à§© à¦¦à¦¾à¦°à§à¦¨à¦¨à¦¾à¦œà¦¾à¦¤ à¦¸à¦¿à¦¦à§à¦¦à¦¿à¦•à¦¿à¦¯à¦¼à¦¾ à¦•à¦¾à¦®à¦¿à¦² à¦®à¦¾à¦¦à§à¦°à¦¾à¦¸à¦¾ à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦à¦¸à§‹à¦¸à¦¿à¦¯à¦¼à§‡à¦¶à¦¨à¥¤ à¦¸à¦°à§à¦¬à¦¸à§à¦¬à¦¤à§à¦¬ à¦¸à¦‚à¦°à¦•à§à¦·à¦¿à¦¤à¥¤" data-en="&copy; 2023 Darunnazat Siddikia Kamil Madrasah Alumni Association. All rights reserved.">&copy; 2023 Darunnazat Siddikia Kamil Madrasah Alumni Association. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- ===== MODALS ===== -->
    <!-- Login Modal -->
    <div id="login-modal" class="modal">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-primary bangla-text" data-bn="à¦²à¦—à¦‡à¦¨" data-en="Login">Login</h3>
                <button class="close-modal text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label for="login-email" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦‡à¦®à§‡à¦‡à¦²" data-en="Email">Email</label>
                    <input type="email" id="login-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                <div>
                    <label for="login-password" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡" data-en="Password">Password</label>
                    <input type="password" id="login-password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                <button type="submit" class="w-full bg-primary hover:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition duration-300 btn-icon" id="login-submit-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span class="btn-text bangla-text" data-bn="à¦²à¦—à¦‡à¦¨" data-en="Login">Login</span>
                    <span class="loading hidden"></span>
                </button>
            </form>
           <p class="mt-4 text-center text-gray-600 bangla-text" 
   data-bn="à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¨à§‡à¦‡? <button class='text-primary hover:underline switch-to-register'>à¦à¦–à¦¾à¦¨à§‡ à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦° à¦•à¦°à§à¦¨</button>" 
   data-en="Don't have an account? <button class='text-primary hover:underline switch-to-register'>Register here</button>">
   Don't have an account? <button class="text-primary hover:underline switch-to-register">Register here</button>
</p>

<p class="mt-2 text-center text-gray-600 bangla-text" 
   data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦­à§à¦²à§‡ à¦—à§‡à¦›à§‡à¦¨? <button class='text-primary hover:underline' id='forgot-password-btn'>à¦à¦–à¦¾à¦¨à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨</button>" 
   data-en="Forgot password? <button class='text-primary hover:underline' id='forgot-password-btn'>Click here</button>">
   Forgot password? <button class="text-primary hover:underline" id="forgot-password-btn">Click here</button>
</p>
        </div>
    </div>

    <!-- Registration Modal -->
    <div id="register-modal" class="modal">
        <div class="bg-white rounded-xl p-8 max-w-2xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-primary bangla-text" data-bn="à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨" data-en="Alumni Registration">Alumni Registration</h3>
                <button class="close-modal text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="register-form" class="space-y-6">
                <div>
                    <h4 class="text-lg font-bold text-primary mb-4 bangla-text" data-bn="à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Personal Information">Personal Information</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="full-name" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà§à¦°à§‹ à¦¨à¦¾à¦® *" data-en="Full Name *">Full Name *</label>
                            <input type="text" id="full-name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="reg-email" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦‡à¦®à§‡à¦‡à¦² à¦ à¦¿à¦•à¦¾à¦¨à¦¾ *" data-en="Email Address *">Email Address *</label>
                            <input type="email" id="reg-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="phone" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦«à§‹à¦¨ à¦¨à¦®à§à¦¬à¦° *" data-en="Phone Number *">Phone Number *</label>
                            <input type="tel" id="phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="dob" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦œà¦¨à§à¦® à¦¤à¦¾à¦°à¦¿à¦– *" data-en="Date of Birth *">Date of Birth *</label>
                            <input type="date" id="dob" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="gender" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦²à¦¿à¦™à§à¦— *" data-en="Gender *">Gender *</label>
                            <select id="gender" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                <option value="male" data-bn="à¦ªà§à¦°à§à¦·" data-en="Male">Male</option>
                                <option value="female" data-bn="à¦®à¦¹à¦¿à¦²à¦¾" data-en="Female">Female</option>
                                <option value="other" data-bn="à¦…à¦¨à§à¦¯à¦¾à¦¨à§à¦¯" data-en="Other">Other</option>
                            </select>
                        </div>
                        <div class="md:col-span-2">
                            <label for="address" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ à¦¿à¦•à¦¾à¦¨à¦¾" data-en="Address">Address</label>
                            <input type="text" id="address" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold text-primary mb-4 bangla-text" data-bn="à¦¶à¦¿à¦•à§à¦·à¦¾à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Academic Information">Academic Information</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="batch" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¬à§à¦¯à¦¾à¦š *" data-en="Batch *">Batch *</label>
                            <select id="batch" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                <option value="" class="bangla-text" data-bn="à¦¬à§à¦¯à¦¾à¦š à¦¨à¦¿à¦°à§à¦¬à¦¾à¦šà¦¨ à¦•à¦°à§à¦¨" data-en="Select Batch">Select Batch</option>
                                <option value="Dakhil 2018" class="bangla-text" data-bn="à¦¦à¦¾à¦–à¦¿à¦² à§¨à§¦à§§à§®" data-en="Dakhil 2018">Dakhil 2018</option>
                                <option value="Dakhil 2019" class="bangla-text" data-bn="à¦¦à¦¾à¦–à¦¿à¦² à§¨à§¦à§§à§¯" data-en="Dakhil 2019">Dakhil 2019</option>
                                <option value="Dakhil 2020" class="bangla-text" data-bn="à¦¦à¦¾à¦–à¦¿à¦² à§¨à§¦à§¨à§¦" data-en="Dakhil 2020">Dakhil 2020</option>
                                <option value="Alim 2020" class="bangla-text" data-bn="à¦†à¦²à¦¿à¦® à§¨à§¦à§¨à§¦" data-en="Alim 2020">Alim 2020</option>
                                <option value="Alim 2021" class="bangla-text" data-bn="à¦†à¦²à¦¿à¦® à§¨à§¦à§¨à§§" data-en="Alim 2021">Alim 2021</option>
                                <option value="Alim 2022" class="bangla-text" data-bn="à¦†à¦²à¦¿à¦® à§¨à§¦à§¨à§¨" data-en="Alim 2022">Alim 2022</option>
                            </select>
                        </div>
                        <div>
                            <label for="student-id" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦†à¦‡à¦¡à¦¿" data-en="Student ID">Student ID</label>
                            <input type="text" id="student-id" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        </div>
                        <div>
                            <label for="passing-year" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà¦¾à¦¸à§‡à¦° à¦¬à¦›à¦° *" data-en="Passing Year *">Passing Year *</label>
                            <input type="number" id="passing-year" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="department" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¬à¦¿à¦­à¦¾à¦—" data-en="Department">Department</label>
                            <input type="text" id="department" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold text-primary mb-4 bangla-text" data-bn="à¦ªà§‡à¦¶à¦¾à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Professional Information">Professional Information</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="profession" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨ à¦ªà§‡à¦¶à¦¾ *" data-en="Current Profession *">Current Profession *</label>
                            <input type="text" id="profession" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="company" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦¸à¦‚à¦¸à§à¦¥à¦¾/à¦•à§‹à¦®à§à¦ªà¦¾à¦¨à¦¿" data-en="Organization/Company">Organization/Company</label>
                            <input type="text" id="company" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        </div>
                        <div>
                            <label for="designation" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà¦¦à¦¬à§€" data-en="Designation">Designation</label>
                            <input type="text" id="designation" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        </div>
                        <div>
                            <label for="work-location" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦•à¦¾à¦œà§‡à¦° à¦…à¦¬à¦¸à§à¦¥à¦¾à¦¨" data-en="Work Location">Work Location</label>
                            <input type="text" id="work-location" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold text-primary mb-4 bangla-text" data-bn="à¦¸à§‹à¦¶à§à¦¯à¦¾à¦² à¦®à¦¿à¦¡à¦¿à¦¯à¦¼à¦¾ (à¦à¦šà§à¦›à¦¿à¦•)" data-en="Social Media (Optional)">Social Media (Optional)</h4>
                    <div class="space-y-4">
                        <div>
                            <label for="facebook" class="block text-gray-700 mb-2">Facebook</label>
                            <input type="url" id="facebook" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" placeholder="https://facebook.com/username">
                        </div>
                        <div>
                            <label for="linkedin" class="block text-gray-700 mb-2">LinkedIn</label>
                            <input type="url" id="linkedin" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" placeholder="https://linkedin.com/in/username">
                        </div>
                        <div>
                            <label for="whatsapp" class="block text-gray-700 mb-2">WhatsApp</label>
                            <input type="tel" id="whatsapp" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" placeholder="+8801XXXXXXXXX">
                        </div>
                    </div>
                </div>
                
                <div>
                    <h4 class="text-lg font-bold text-primary mb-4 bangla-text" data-bn="à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦¸à§à¦°à¦•à§à¦·à¦¾" data-en="Account Security">Account Security</h4>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="reg-password" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ *" data-en="Password *">Password *</label>
                            <input type="password" id="reg-password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                        <div>
                            <label for="confirm-password" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à§à¦¨ *" data-en="Confirm Password *">Confirm Password *</label>
                            <input type="password" id="confirm-password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                        </div>
                    </div>
                </div>
                
                <div>
                    <label for="profile-picture" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦² à¦›à¦¬à¦¿" data-en="Profile Picture">Profile Picture</label>
                    <input type="file" id="profile-picture" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                </div>
                
                <div class="flex items-start">
                    <input type="checkbox" id="terms" class="mt-1 mr-2" required>
                    <label for="terms" class="text-gray-700 bangla-text" data-bn="à¦†à¦®à¦¿ <a href='#' class='text-primary hover:underline'>à¦¸à¦°à§à¦¤ à¦“ à¦¶à¦°à§à¦¤à¦¾à¦¬à¦²à§€</a> à¦à¦¬à¦‚ <a href='#' class='text-primary hover:underline'>à¦—à§‹à¦ªà¦¨à§€à¦¯à¦¼à¦¤à¦¾ à¦¨à§€à¦¤à¦¿</a> à¦®à§‡à¦¨à§‡ à¦šà¦²à¦¤à§‡ à¦¸à¦®à§à¦®à¦¤" data-en="I agree to the <a href='#' class='text-primary hover:underline'>Terms & Conditions</a> and <a href='#' class='text-primary hover:underline'>Privacy Policy</a>">I agree to the <a href="#" class="text-primary hover:underline">Terms & Conditions</a> and <a href="#" class="text-primary hover:underline">Privacy Policy</a></label>
                </div>
                
                <button type="submit" class="w-full bg-primary hover:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition duration-300 btn-icon" id="register-submit-btn">
                    <i class="fas fa-user-plus"></i>
                    <span class="btn-text bangla-text" data-bn="à¦à¦–à¦¨à¦‡ à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦° à¦•à¦°à§à¦¨" data-en="Register Now">Register Now</span>
                    <span class="loading hidden"></span>
                </button>
            </form>
            <p class="mt-4 text-center text-gray-600 bangla-text" data-bn="à¦‡à¦¤à¦¿à¦®à¦§à§à¦¯à§‡ à¦à¦•à¦Ÿà¦¿ à¦…à§à¦¯à¦¾à¦•à¦¾à¦‰à¦¨à§à¦Ÿ à¦†à¦›à§‡? <button class='text-primary hover:underline switch-to-login'>à¦à¦–à¦¾à¦¨à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨</button>" data-en="Already have an account? <button class='text-primary hover:underline switch-to-login'>Login here</button>">Already have an account? <button class="text-primary hover:underline switch-to-login">Login here</button></p>
        </div>
    </div>

    <!-- Admin Login Modal -->
    <div id="admin-login-modal" class="modal">
        <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-primary bangla-text" data-bn="à¦…à§à¦¯à¦¾à¦¡à¦®à¦¿à¦¨ à¦²à¦—à¦‡à¦¨" data-en="Admin Login">Admin Login</h3>
                <button class="close-modal text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="admin-login-form" class="space-y-4">
                <div>
                    <label for="admin-username" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦‡à¦‰à¦œà¦¾à¦°à¦¨à§‡à¦®" data-en="Username">Username</label>
                    <input type="text" id="admin-username" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                <div>
                    <label for="admin-password" class="block text-gray-700 mb-2 bangla-text" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡" data-en="Password">Password</label>
                    <input type="password" id="admin-password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                </div>
                <button type="submit" class="w-full bg-primary hover:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition duration-300 btn-icon" id="admin-login-submit-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span class="btn-text bangla-text" data-bn="à¦²à¦—à¦‡à¦¨" data-en="Login">Login</span>
                    <span class="loading hidden"></span>
                </button>
            </form>
        </div>
    </div>

    <!-- Member Details Modal -->
    <div id="member-modal" class="modal">
        <div class="bg-white rounded-xl p-8 max-w-4xl w-full mx-4 max-h-screen overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-primary bangla-text" data-bn="à¦¸à¦¦à¦¸à§à¦¯ à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤" data-en="Member Details">Member Details</h3>
                <button class="close-modal text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <div id="member-modal-content">
                <!-- Member details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Forgot Password Modal -->
<div id="forgot-password-modal" class="modal">
    <div class="bg-white rounded-xl p-8 max-w-md w-full mx-4">
        <div class="flex justify-between items-center mb-6">
            <h3 class="text-2xl font-bold text-primary bangla-text" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦°à¦¿à¦¸à§‡à¦Ÿ" data-en="Reset Password">Reset Password</h3>
            <button class="close-modal text-gray-500 hover:text-gray-700">
                <i class="fas fa-times text-xl"></i>
            </button>
        </div>
        <form id="forgot-password-form" class="space-y-4">
            <div>
                <label class="block text-gray-700 mb-2 bangla-text" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦®à§‡à¦‡à¦²" data-en="Your Email">Your Email</label>
                <input type="email" id="reset-email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
            </div>
            <button type="submit" class="w-full bg-primary hover:bg-green-800 text-white font-medium py-3 px-6 rounded-lg transition duration-300 btn-icon">
                <i class="fas fa-paper-plane"></i>
                <span class="btn-text bangla-text" data-bn="à¦°à¦¿à¦¸à§‡à¦Ÿ à¦²à¦¿à¦‚à¦• à¦ªà¦¾à¦ à¦¾à¦¨" data-en="Send Reset Link">Send Reset Link</span>
            </button>
        </form>
        <p class="mt-4 text-center text-gray-600 text-sm bangla-text" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦®à§‡à¦‡à¦²à§‡ à¦à¦•à¦Ÿà¦¿ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦°à¦¿à¦¸à§‡à¦Ÿ à¦²à¦¿à¦‚à¦• à¦ªà¦¾à¦ à¦¾à¦¨à§‹ à¦¹à¦¬à§‡" data-en="A password reset link will be sent to your email">A password reset link will be sent to your email</p>
    </div>
</div>

    <!-- ===== DASHBOARD CONTENT ===== -->
    <div id="dashboard-content" class="hidden">
        <!-- Dashboard content will be loaded here -->
    </div>

    <!-- ===== ADMIN PANEL CONTENT ===== -->
    <div id="admin-panel-content" class="hidden">
        <!-- Admin panel content will be loaded here -->
    </div>


    <!-- ... all your existing HTML ... -->

<!-- Footer -->
<footer class="bg-dark text-white py-12">
    <!-- ... footer content ... -->
</footer>


<!-- ===== FLOATING ROUND LANGUAGE BUTTONS ===== -->
<div class="fixed bottom-6 right-6 z-50 flex flex-col space-y-2">
    <button class="lang-btn bg-primary text-white w-10 h-10 rounded-full shadow-lg font-medium active transition-all duration-300 flex items-center justify-center" data-lang="en" title="English">
        EN
    </button>
    <button class="lang-btn bg-gray-200 text-gray-700 w-10 h-10 rounded-full shadow-lg font-medium transition-all duration-300 flex items-center justify-center" data-lang="bn" title="à¦¬à¦¾à¦‚à¦²à¦¾">
        BN
    </button>
</div>



<!-- JavaScript -->
<script>
    // ... your existing JavaScript ...
</script>

    <!-- ===== JAVASCRIPT ===== -->
    <script>
        // ===== CONFIGURATION & INIT =====
        const SUPABASE_URL = 'https://hxastsxvqpkqqctsfcbl.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imh4YXN0c3h2cXBrcXFjdHNmY2JsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIxNjMzODYsImV4cCI6MjA3NzczOTM4Nn0.IxyvgAHcJ_2rxY1lp7VTHeSfKQWyle2bgAzSoQCqCgg';
        
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Application State
        let currentUser = null;
        let isAdmin = false;
        let userProfile = null;
        let currentMembersPage = 1;
        const membersPerPage = 6;
        let currentLanguage = 'en';
        let formEventListeners = new Map();
        let currentGalleryImages = [];
        let currentGalleryIndex = 0;
        let currentGalleryId = null;

        // Initialize Application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            setupEventListeners();
            loadInitialData();
        });


        // ===== IMAGE RESIZE FUNCTION =====
function resizeImage(file, maxWidth, maxHeight, quality = 0.8) {
    return new Promise((resolve) => {
        const canvas = document.createElement('canvas');
        const ctx = canvas.getContext('2d');
        const img = new Image();
        
        img.onload = function() {
            let width = img.width;
            let height = img.height;
            
            if (width > height) {
                if (width > maxWidth) {
                    height = Math.round((height * maxWidth) / width);
                    width = maxWidth;
                }
            } else {
                if (height > maxHeight) {
                    width = Math.round((width * maxHeight) / height);
                    height = maxHeight;
                }
            }
            
            canvas.width = width;
            canvas.height = height;
            ctx.drawImage(img, 0, 0, width, height);
            canvas.toBlob(resolve, 'image/webp', quality);
        };
        
        img.src = URL.createObjectURL(file);
    });
}

        // ===== LANGUAGE SYSTEM =====
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.body.setAttribute('data-lang', lang);
            
            // Update all elements with data attributes
            document.querySelectorAll('[data-bn]').forEach(element => {
                const text = element.getAttribute(`data-${lang}`);
                if (text) {
                    // Handle HTML content for labels with links
                    if (text.includes('<a') || text.includes('<button')) {
                        element.innerHTML = text;
                    } else {
                        element.textContent = text;
                    }
                }
            });
            
            // Update language buttons active state
            document.querySelectorAll('.lang-btn').forEach(btn => {
                if (btn.getAttribute('data-lang') === lang) {
                    btn.classList.add('active', 'bg-primary', 'text-white');
                    btn.classList.remove('bg-gray-200', 'text-gray-700');
                } else {
                    btn.classList.remove('active', 'bg-primary', 'text-white');
                    btn.classList.add('bg-gray-200', 'text-gray-700');
                }
            });
            
            // Update select options
            document.querySelectorAll('select option').forEach(option => {
                const bnText = option.getAttribute('data-bn');
                const enText = option.getAttribute('data-en');
                if (bnText && enText) {
                    option.textContent = lang === 'bn' ? bnText : enText;
                }
            });
            
            // Update input placeholders
            document.querySelectorAll('input[data-bn]').forEach(input => {
                const placeholder = input.getAttribute(`data-${lang}`);
                if (placeholder) {
                    input.placeholder = placeholder;
                }
            });
        }

        // ===== NOTIFICATION SYSTEM =====
        function showNotification(message, type = 'success') {
            const notification = document.getElementById('notification');
            const messageEl = document.getElementById('notification-message');
            const icon = notification.querySelector('i');
            
            messageEl.textContent = message;
            notification.className = `notification ${type}`;
            
            if (type === 'success') {
                icon.className = 'fas fa-check-circle';
            } else if (type === 'error') {
                icon.className = 'fas fa-exclamation-circle';
            } else {
                icon.className = 'fas fa-info-circle';
            }
            
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        // Loading state for buttons
        function setButtonLoading(button, isLoading) {
            const btnText = button.querySelector('.btn-text');
            const loading = button.querySelector('.loading');
            
            if (isLoading) {
                btnText.classList.add('hidden');
                loading.classList.remove('hidden');
                button.disabled = true;
            } else {
                btnText.classList.remove('hidden');
                loading.classList.add('hidden');
                button.disabled = false;
            }
        }

        // Welcome Modal
        function showWelcomeModal(isNewUser = true) {
            const welcomeModal = document.getElementById('welcome-modal');
            const welcomeTitle = document.getElementById('welcome-title');
            const welcomeMessage = document.getElementById('welcome-message');
            
            if (isNewUser) {
                welcomeTitle.textContent = currentLanguage === 'bn' ? 'à¦†à¦®à¦¾à¦¦à§‡à¦° à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦•à¦®à¦¿à¦‰à¦¨à¦¿à¦Ÿà¦¿à¦¤à§‡ à¦¸à§à¦¬à¦¾à¦—à¦¤à¦®!' : 'Welcome to Our Alumni Community!';
                welcomeMessage.textContent = currentLanguage === 'bn' ? 
                    'à¦†à¦®à¦°à¦¾ à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦•à§à¦°à¦®à¦¬à¦°à§à¦§à¦®à¦¾à¦¨ à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦¨à§‡à¦Ÿà¦“à¦¯à¦¼à¦¾à¦°à§à¦•à§‡ à¦¯à§‹à¦—à¦¦à¦¾à¦¨ à¦•à¦°à¦¤à§‡ à¦ªà§‡à¦°à§‡ à¦‰à¦¤à§à¦¤à§‡à¦œà¦¿à¦¤à¥¤ à¦¬à§à¦¯à¦¾à¦šà¦®à§‡à¦Ÿà¦¦à§‡à¦° à¦¸à¦¾à¦¥à§‡ à¦¸à¦‚à¦¯à§‹à¦— à¦¸à§à¦¥à¦¾à¦ªà¦¨ à¦•à¦°à§à¦¨, à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦¸à¦®à§à¦ªà¦°à§à¦•à§‡ à¦†à¦ªà¦¡à§‡à¦Ÿ à¦¥à¦¾à¦•à§à¦¨ à¦à¦¬à¦‚ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦ªà§à¦°à¦¾à¦£à¦¬à¦¨à§à¦¤ à¦¸à¦®à§à¦ªà§à¦°à¦¦à¦¾à¦¯à¦¼à§‡à¦° à¦…à¦‚à¦¶ à¦¹à¦¨à¥¤' :
                    "We're excited to have you join our growing network of alumni. Connect with batchmates, stay updated with events, and be part of our vibrant community.";
            } else {
                welcomeTitle.textContent = currentLanguage === 'bn' ? 'à¦«à¦¿à¦°à§‡ à¦†à¦¸à¦¾à¦° à¦œà¦¨à§à¦¯ à¦¸à§à¦¬à¦¾à¦—à¦¤à¦®!' : 'Welcome Back!';
                welcomeMessage.textContent = currentLanguage === 'bn' ? 
                    'à¦†à¦ªà¦¨à¦¾à¦•à§‡ à¦†à¦¬à¦¾à¦° à¦¦à§‡à¦–à§‡ à¦­à¦¾à¦²à§‹ à¦²à¦¾à¦—à¦²à§‹! à¦†à¦ªà¦¨à¦¾à¦° à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦² à¦šà§‡à¦• à¦†à¦‰à¦Ÿ à¦•à¦°à§à¦¨ à¦à¦¬à¦‚ à¦†à¦¸à¦¨à§à¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦¦à§‡à¦–à§à¦¨à¥¤' :
                    "Great to see you again! Check out your profile and upcoming events.";
            }
            
            welcomeModal.classList.add('active');
        }

        async function initializeApp() {
            // Check for user session
            const { data: { user } } = await supabase.auth.getUser();
            if (user) {
                currentUser = user;
                await loadUserProfile();
                updateUI();
            }
            
            // Check for admin session from localStorage
            const adminSession = localStorage.getItem('adminSession');
            if (adminSession) {
                isAdmin = true;
                updateUI();
            }
        }

        async function loadUserProfile() {
            if (!currentUser) return;
            
            try {
                const { data, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('email', currentUser.email)
                    .single();
                
                if (error) {
                    console.error('Error loading profile:', error);
                    
                    // If profile doesn't exist, create a basic one
                    if (error.code === 'PGRST116') {
                        console.log('Creating basic profile for user:', currentUser.id);
                        const { data: newProfile, error: createError } = await supabase
                            .from('profiles')
                            .insert([{
                                id: currentUser.id,
                                email: currentUser.email,
                                full_name: currentUser.email.split('@')[0],
                                show_in_site: false
                            }])
                            .select()
                            .single();
                        
                        if (!createError && newProfile) {
                            userProfile = newProfile;
                            console.log('Basic profile created:', userProfile);
                        } else {
                            console.error('Error creating basic profile:', createError);
                        }
                    }
                    return;
                }
                
                if (data) {
                    userProfile = data;
                    console.log('Profile loaded successfully:', userProfile);
                }
            } catch (error) {
                console.error('Error in loadUserProfile:', error);
            }
        }

        function updateUI() {
            const userSection = document.getElementById('user-section');
            const adminSection = document.getElementById('admin-section');
            const authButtons = document.getElementById('auth-buttons');
            const mobileUserSection = document.getElementById('mobile-user-section');
            const mobileAdminSection = document.getElementById('mobile-admin-section');
            const mobileAuthButtons = document.getElementById('mobile-auth-buttons');
            
            if (currentUser && !isAdmin) {
                // User is logged in as regular user
                userSection.classList.remove('hidden');
                adminSection.classList.add('hidden');
                authButtons.classList.add('hidden');
                mobileUserSection.classList.remove('hidden');
                mobileAdminSection.classList.add('hidden');
                mobileAuthButtons.classList.add('hidden');
                
                const displayName = userProfile?.full_name || currentUser.email.split('@')[0];
                const firstLetter = displayName.charAt(0).toUpperCase();
                
                // Update user avatar with photo or initial
                const userAvatar = document.getElementById('user-avatar');
                const mobileUserAvatar = document.getElementById('mobile-user-avatar');
                
                if (userProfile?.profile_picture_url) {
                    userAvatar.innerHTML = `<img src="${userProfile.profile_picture_url}" alt="${displayName}">`;
                    mobileUserAvatar.innerHTML = `<img src="${userProfile.profile_picture_url}" alt="${displayName}">`;
                } else {
                    userAvatar.textContent = firstLetter;
                    mobileUserAvatar.textContent = firstLetter;
                }
                
                document.getElementById('mobile-user-name').textContent = displayName;
                
                // Update dashboard button text with user's name
                const userNameDisplay = document.getElementById('user-name-display');
                const mobileUserNameDisplay = document.getElementById('mobile-user-name-display');
                
                if (userNameDisplay) {
                    userNameDisplay.textContent = displayName;
                    userNameDisplay.setAttribute('data-bn', displayName);
                    userNameDisplay.setAttribute('data-en', displayName);
                }
                if (mobileUserNameDisplay) {
                    mobileUserNameDisplay.textContent = displayName;
                    mobileUserNameDisplay.setAttribute('data-bn', displayName);
                    mobileUserNameDisplay.setAttribute('data-en', displayName);
                }
            } else if (isAdmin) {
                // Admin is logged in
                userSection.classList.add('hidden');
                adminSection.classList.remove('hidden');
                authButtons.classList.add('hidden');
                mobileUserSection.classList.add('hidden');
                mobileAdminSection.classList.remove('hidden');
                mobileAuthButtons.classList.add('hidden');
            } else {
                // No one is logged in
                userSection.classList.add('hidden');
                adminSection.classList.add('hidden');
                authButtons.classList.remove('hidden');
                mobileUserSection.classList.add('hidden');
                mobileAdminSection.classList.add('hidden');
                mobileAuthButtons.classList.remove('hidden');
            }
        }

        function showModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }

        function hideAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.classList.remove('active');
            });
        }

        // ===== EVENT LISTENERS =====
        function setupEventListeners() {
            // Language toggle - Fixed to work on both desktop and mobile
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const lang = this.getAttribute('data-lang');
                    switchLanguage(lang);
                });
            });


            // Mobile tooltip on click
if ('ontouchstart' in window) {
    document.addEventListener('click', function(e) {
        const btn = e.target.closest('.admin-action-btn, .btn-icon-only');
        
        // Remove all existing tooltips
        document.querySelectorAll('.show-tooltip').forEach(el => {
            if (el !== btn) el.classList.remove('show-tooltip');
        });
        
        // Toggle tooltip on clicked button
        if (btn && btn.hasAttribute('title')) {
            e.preventDefault();
            e.stopPropagation();
            btn.classList.toggle('show-tooltip');
            
            // Auto-hide after 2 seconds
            if (btn.classList.contains('show-tooltip')) {
                setTimeout(() => btn.classList.remove('show-tooltip'), 2000);
            }
        }
    });
    
    // Hide tooltip when clicking elsewhere
    document.addEventListener('click', function(e) {
        if (!e.target.closest('.admin-action-btn, .btn-icon-only')) {
            document.querySelectorAll('.show-tooltip').forEach(el => {
                el.classList.remove('show-tooltip');
            });
        }
    });
}


            // Mobile menu
            document.getElementById('mobile-menu-button').addEventListener('click', function() {
                document.getElementById('mobile-menu').classList.add('active');
            });
            
            document.querySelector('.close-mobile-menu').addEventListener('click', function() {
                document.getElementById('mobile-menu').classList.remove('active');
            });

            // Close mobile menu when clicking links
            document.querySelectorAll('[data-close-menu]').forEach(link => {
                link.addEventListener('click', function() {
                    document.getElementById('mobile-menu').classList.remove('active');
                });
            });

            // Close modals when clicking outside
            document.querySelectorAll('.modal').forEach(modal => {
                modal.addEventListener('click', function(e) {
                    if (e.target === this) {
                        hideAllModals();
                    }
                });
            });

            // Navigation links - Fixed to work in all modes
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Always show main site when clicking navigation links
                    showMainSite();
                    
                    const targetId = this.getAttribute('href');
                    if (targetId === '#') return;
                    
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        window.scrollTo({
                            top: targetElement.offsetTop - 80,
                            behavior: 'smooth'
                        });
                        
                        document.getElementById('mobile-menu').classList.remove('active');
                    }
                });
            });

            // Login buttons
            document.getElementById('login-btn').addEventListener('click', function() {
                showModal('login-modal');
            });

            // Register buttons
            document.getElementById('register-btn').addEventListener('click', function() {
                showModal('register-modal');
            });

            // Forgot Password button
document.getElementById('forgot-password-btn').addEventListener('click', function() {
    hideAllModals();
    showModal('forgot-password-modal');
});

            // Admin login buttons
            document.getElementById('admin-login-btn')?.addEventListener('click', function() {
                showModal('admin-login-modal');
            });

            // Hero register button
            document.getElementById('hero-register-btn').addEventListener('click', function() {
                showModal('register-modal');
            });

            // Mobile buttons
            document.getElementById('mobile-login-btn').addEventListener('click', function() {
                showModal('login-modal');
            });

            document.getElementById('mobile-register-btn').addEventListener('click', function() {
                showModal('register-modal');
            });

            document.getElementById('mobile-admin-login-btn')?.addEventListener('click', function() {
                showModal('admin-login-modal');
            });

            // Close modals
            document.querySelectorAll('.close-modal').forEach(btn => {
                btn.addEventListener('click', hideAllModals);
            });

         // Switch between login and register - FIXED VERSION
document.addEventListener('click', function(e) {
    // Handle "Register here" button in login modal
    if (e.target.classList.contains('switch-to-register')) {
        e.preventDefault();
        hideAllModals();
        showModal('register-modal');
    }
    
    // Handle "Login here" button in register modal  
    if (e.target.classList.contains('switch-to-login')) {
        e.preventDefault();
        hideAllModals();
        showModal('login-modal');
    }
    
    // Handle "Forgot password" button
    if (e.target.id === 'forgot-password-btn' || e.target.closest('#forgot-password-btn')) {
        e.preventDefault();
        hideAllModals();
        showModal('forgot-password-modal');
    }
});
            // Login form
            setupFormListener('login-form', handleLogin);

            // Admin login form
            setupFormListener('admin-login-form', handleAdminLogin);

            // Register form
            setupFormListener('register-form', handleRegistration);

            // Forgot Password form
setupFormListener('forgot-password-form', async function(e) {
    e.preventDefault();
    const email = document.getElementById('reset-email').value;
    
    const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo: 'https://your-website.com/update-password' // Change to your actual website URL
    });
    
    if (error) {
        showNotification('Error: ' + error.message, 'error');
    } else {
        showNotification('Password reset link sent to your email! Check your inbox.', 'success');
        hideAllModals();
        document.getElementById('forgot-password-form').reset();
    }
});


            // Contact form
            setupFormListener('contact-form', handleContactForm);

            // Dashboard buttons
            document.getElementById('dashboard-btn')?.addEventListener('click', function() {
                showDashboard();
            });

            document.getElementById('mobile-dashboard-btn')?.addEventListener('click', function() {
                showDashboard();
            });

            // Admin panel buttons
            document.getElementById('admin-panel-btn')?.addEventListener('click', function() {
                showAdminPanel();
            });

            document.getElementById('mobile-admin-panel-btn')?.addEventListener('click', function() {
                showAdminPanel();
            });

            // Logout buttons
            document.getElementById('logout-btn')?.addEventListener('click', handleUserLogout);
            document.getElementById('mobile-logout-btn')?.addEventListener('click', handleUserLogout);

            // Admin logout buttons
            document.getElementById('admin-logout-btn')?.addEventListener('click', handleAdminLogout);
            document.getElementById('mobile-admin-logout-btn')?.addEventListener('click', handleAdminLogout);

            // Member search functionality
            document.getElementById('member-search').addEventListener('input', function() {
                filterMembers(this.value);
            });

            // Batch filter buttons
            document.querySelectorAll('.batch-filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const batch = this.getAttribute('data-batch');
                    filterByBatch(batch);
                    
                    document.querySelectorAll('.batch-filter-btn').forEach(b => {
                        b.classList.remove('active', 'bg-primary', 'text-white');
                        b.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    this.classList.remove('bg-gray-200', 'text-gray-700');
                    this.classList.add('active', 'bg-primary', 'text-white');
                });
            });

            // View more members button
            document.getElementById('view-more-members').addEventListener('click', function() {
                currentMembersPage++;
                loadMembers();
            });

            // Close welcome modal
            document.getElementById('close-welcome').addEventListener('click', function() {
                document.getElementById('welcome-modal').classList.remove('active');
            });

            // Gallery modal navigation
            document.querySelector('.gallery-close').addEventListener('click', function() {
                hideAllModals();
            });

            document.querySelector('.gallery-nav.prev').addEventListener('click', function() {
                navigateGallery(-1);
            });

            document.querySelector('.gallery-nav.next').addEventListener('click', function() {
                navigateGallery(1);
            });

            // Close gallery with escape key
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    hideAllModals();
                }
            });

            // View all photos button
            document.getElementById('view-all-photos')?.addEventListener('click', function() {
                openGalleryModal(0);
            });
        }

        // Helper function to setup form listeners without duplicates
        function setupFormListener(formId, handler) {
            const form = document.getElementById(formId);
            if (!form) return;
            
            // Remove existing listener if any
            const existingListener = formEventListeners.get(formId);
            if (existingListener) {
                form.removeEventListener('submit', existingListener);
            }
            
            // Add new listener
            const newListener = async function(e) {
                e.preventDefault();
                await handler.call(this, e);
            };
            
            form.addEventListener('submit', newListener);
            formEventListeners.set(formId, newListener);
        }

        // ===== AUTHENTICATION =====
        async function handleLogin(e) {
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            const submitBtn = document.getElementById('login-submit-btn');

            setButtonLoading(submitBtn, true);

            const { data, error } = await supabase.auth.signInWithPassword({
                email: email,
                password: password
            });

            setButtonLoading(submitBtn, false);

            if (error) {
                showNotification('Login failed: ' + error.message, 'error');
                return;
            }

            currentUser = data.user;
            isAdmin = false;
            localStorage.removeItem('adminSession');
            await loadUserProfile();
            updateUI();
            
            // Force UI update after profile loads
            setTimeout(() => {
                updateUI();
            }, 500);
            
            hideAllModals();
            showWelcomeModal(false);
            
            // Auto-redirect regular users to dashboard
            showDashboard();
        }

        async function handleAdminLogin(e) {
            const username = document.getElementById('admin-username').value;
            const password = document.getElementById('admin-password').value;
            const submitBtn = document.getElementById('admin-login-submit-btn');

            setButtonLoading(submitBtn, true);

            try {
                const { data, error } = await supabase
                    .from('admin_users')
                    .select('*')
                    .eq('username', username)
                    .eq('password', password)
                    .single();

                if (error) throw error;

                if (data) {
                    isAdmin = true;
                    currentUser = null;
                    localStorage.setItem('adminSession', 'true');
                    hideAllModals();
                    showNotification('Admin login successful!', 'success');
                    updateUI();
                    showAdminPanel(); // Automatically show admin panel after login
                } else {
                    showNotification('Invalid admin credentials', 'error');
                }
            } catch (error) {
                showNotification('Invalid admin credentials', 'error');
            }

            setButtonLoading(submitBtn, false);
        }

        async function handleRegistration(e) {
    e.preventDefault();
    
    const email = document.getElementById('reg-email').value;
    const password = document.getElementById('reg-password').value;
    const confirmPassword = document.getElementById('confirm-password').value;
    const profilePicture = document.getElementById('profile-picture').files[0];
    const submitBtn = document.getElementById('register-submit-btn');

    // Validate passwords match first
    if (password !== confirmPassword) {
        showNotification('Passwords do not match', 'error');
        return;
    }

    // Validate other required fields
    const fullName = document.getElementById('full-name').value;
    const phone = document.getElementById('phone').value;
    const batch = document.getElementById('batch').value;
    const passingYear = document.getElementById('passing-year').value;
    const profession = document.getElementById('profession').value;

    if (!fullName || !phone || !batch || !passingYear || !profession) {
        showNotification('Please fill in all required fields', 'error');
        return;
    }

    setButtonLoading(submitBtn, true);

    let profilePictureUrl = null;
    let uploadError = null;

    try {
        // Step 1: First create the user account
        const { data: authData, error: authError } = await supabase.auth.signUp({
            email: email,
            password: password,
        });

        if (authError) throw authError;

        if (profilePicture && authData.user) {
    try {
        // Auto-resize to WebP with 100KB limit
        const resizedBlob = await resizeImage(profilePicture, 400, 400, 0.7);
        const resizedFile = new File([resizedBlob], `profile-${Date.now()}.jpg`, {
            type: 'image/jpeg'
        });
        
        // Check final size - 100KB limit
        if (resizedFile.size > 100 * 1024) {
            throw new Error('Image too large after compression');
        }
        
        const fileName = `${authData.user.id}.webp`;
        const filePath = `profile-pictures/${fileName}`;

        const { data: uploadData, error: uploadError } = await supabase.storage
            .from('profile-pictures')
            .upload(filePath, resizedFile);

        if (uploadError) throw uploadError;

        const { data: urlData } = supabase.storage
            .from('profile-pictures')
            .getPublicUrl(filePath);
        profilePictureUrl = urlData.publicUrl;
        
        // âœ… STORE THE FILENAME LIKE GALLERY DOES
        profilePictureFileName = fileName;
        
    } catch (uploadErr) {
        console.error('Profile picture upload failed:', uploadErr);
        uploadError = uploadErr;
    }
}

        // Step 3: Create profile with or without picture
        const profileData = {
            id: authData.user.id, // Use the auth user ID
            full_name: fullName,
            email: email,
            phone: document.getElementById('phone').value,
            date_of_birth: document.getElementById('dob').value,
            gender: document.getElementById('gender').value,
            address: document.getElementById('address').value,
            batch: batch,
            student_id: document.getElementById('student-id').value,
            passing_year: parseInt(passingYear),
            department: document.getElementById('department').value,
            profession: profession,
            company: document.getElementById('company').value,
            designation: document.getElementById('designation').value,
            work_location: document.getElementById('work-location').value,
            facebook: document.getElementById('facebook').value,
            linkedin: document.getElementById('linkedin').value,
            whatsapp: document.getElementById('whatsapp').value,
            profile_picture_url: profilePictureUrl,
            profile_picture_filename: profilePictureFileName,
            show_in_site: false
        };

        const { data: profileResult, error: profileError } = await supabase
            .from('profiles')
            .insert([profileData]);

        if (profileError) throw profileError;

        setButtonLoading(submitBtn, false);
        
        // Show appropriate success message
        if (uploadError) {
            showNotification('Registration successful! Profile created without picture: ' + uploadError.message, 'info');
        } else {
            showNotification('Registration successful! Please check your email for verification.', 'success');
        }
        
        hideAllModals();
        document.getElementById('register-form').reset();
        
        // Show welcome modal for new users
        showWelcomeModal(true);

    } catch (error) {
        setButtonLoading(submitBtn, false);
        
        // If there was an error after photo upload, try to clean up
        if (profilePictureUrl) {
            try {
                const fileName = `${authData.user.id}.webp`;
                const filePath = `profile-pictures/${fileName}`;
                await supabase.storage.from('profile-pictures').remove([filePath]);
            } catch (cleanupError) {
                console.error('Failed to clean up uploaded photo:', cleanupError);
            }
        }
        
        showNotification('Registration failed: ' + error.message, 'error');
    }
}

        async function handleContactForm(e) {
            const name = document.getElementById('contact-name').value;
            const email = document.getElementById('contact-email').value;
            const batch = document.getElementById('contact-batch').value;
            const message = document.getElementById('contact-message').value;
            
            try {
                const { data, error } = await supabase
                    .from('contact_messages')
                    .insert([{
                        name: name,
                        email: email,
                        subject: `Message from ${name} (Batch: ${batch})`,
                        message: message,
                        status: 'unread'
                    }]);

                if (error) throw error;

                showNotification('Thank you for your message! We will get back to you soon.', 'success');
                document.getElementById('contact-form').reset();

            } catch (error) {
                showNotification('Error sending message: ' + error.message, 'error');
            }
        }

        async function handleUserLogout() {
            await supabase.auth.signOut();
            currentUser = null;
            isAdmin = false;
            localStorage.removeItem('adminSession');
            updateUI();
            showMainSite();
            showNotification('Successfully logged out', 'success');
        }

        async function handleAdminLogout() {
            isAdmin = false;
            localStorage.removeItem('adminSession');
            updateUI();
            showMainSite();
            showNotification('Admin logged out successfully', 'success');
        }

        function showDashboard() {
            document.getElementById('main-content').classList.add('hidden');
            document.getElementById('admin-panel-content').classList.add('hidden');
            document.getElementById('dashboard-content').classList.remove('hidden');
            document.querySelector('footer').classList.add('hidden');
            loadDashboardContent();
        }

        function showAdminPanel() {
            document.getElementById('main-content').classList.add('hidden');
            document.getElementById('dashboard-content').classList.add('hidden');
            document.getElementById('admin-panel-content').classList.remove('hidden');
            document.querySelector('footer').classList.add('hidden');
            loadAdminPanelContent();
        }

        function showMainSite() {
            document.getElementById('dashboard-content').classList.add('hidden');
            document.getElementById('admin-panel-content').classList.add('hidden');
            document.getElementById('main-content').classList.remove('hidden');
            document.querySelector('footer').classList.remove('hidden');
            
            // Reload data when returning to main site
            loadInitialData();
        }

        // ===== DATA LOADING =====
        async function loadInitialData() {
            await loadStats();
            await loadAnnouncements();
            await loadEvents();
            await loadMembers();
            await loadGalleryButtons();
        }

        async function loadStats() {
            try {
                const { count: membersCount, error: membersError } = await supabase
                    .from('profiles')
                    .select('*', { count: 'exact', head: true })
                    .eq('show_in_site', true);

                const { data: batchesData, error: batchesError } = await supabase
                    .from('profiles')
                    .select('batch')
                    .eq('show_in_site', true);

                if (!membersError && !batchesError) {
                    const uniqueBatches = new Set(batchesData.map(item => item.batch)).size;
                    
                    document.getElementById('total-members').textContent = membersCount + '+';
                    document.getElementById('total-batches').textContent = uniqueBatches + '+';
                }
            } catch (error) {
                console.error('Error loading stats:', error);
            }
        }

        async function loadAnnouncements() {
            const container = document.getElementById('announcements-container');
            const loading = document.getElementById('announcements-loading');

            try {
                const { data: announcements, error } = await supabase
                    .from('announcements')
                    .select('*')
                    .order('created_at', { ascending: false })
                    .limit(5);

                if (error) throw error;

                loading.classList.add('hidden');

                if (announcements.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-8">
                            <p class="text-gray-600" data-bn="à¦•à§‹à¦¨ à¦˜à§‹à¦·à¦£à¦¾ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿" data-en="No announcements found">No announcements found</p>
                        </div>
                    `;
                    switchLanguage(currentLanguage);
                    return;
                }

                container.innerHTML = announcements.map(announcement => `
                    <div class="announcement-card-new p-6 hover-lift cursor-pointer">
                        <div class="flex items-start justify-between">
                            <div class="flex-1">
                                <h3 class="text-xl font-bold text-primary mb-2">${announcement.title}</h3>
                                <p class="text-gray-700 mb-4 leading-relaxed">${announcement.content}</p>
                                <div class="flex items-center text-gray-500 text-sm">
                                    <i class="far fa-calendar-alt mr-2"></i>
                                    <span>${new Date(announcement.created_at).toLocaleDateString('bn-BD', { year: 'numeric', month: 'long', day: 'numeric' })}</span>
                                </div>
                            </div>
                            <div class="ml-4">
                                <span class="bg-accent text-white px-3 py-1 rounded-full text-sm font-medium" data-bn="à¦¨à¦¤à§à¦¨" data-en="New">New</span>
                            </div>
                        </div>
                    </div>
                `).join('');

                switchLanguage(currentLanguage);

            } catch (error) {
                loading.classList.add('hidden');
                container.innerHTML = `
                    <div class="text-center py-8">
                        <p class="text-gray-600" data-bn="à¦˜à§‹à¦·à¦£à¦¾ à¦²à§‹à¦¡ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡" data-en="Error loading announcements">Error loading announcements</p>
                    </div>
                `;
                switchLanguage(currentLanguage);
            }
        }

        async function loadEvents() {
    const container = document.getElementById('events-container');
    const loading = document.getElementById('events-loading');

    try {
        const { data: events, error } = await supabase
            .from('events')
            .select('*')
            .order('event_date', { ascending: true })
            .limit(4);

        if (error) throw error;

        loading.classList.add('hidden');

        if (events.length === 0) {
            container.innerHTML = `
                <div class="text-center py-8 col-span-2">
                    <p class="text-gray-600" data-bn="à¦•à§‹à¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿" data-en="No events found">No events found</p>
                </div>
            `;
            switchLanguage(currentLanguage);
            return;
        }

        // Clear the container first
        container.innerHTML = '';

        // Load all events first, then get registration counts
        const eventsWithRegistrations = await Promise.all(events.map(async (event) => {
            const { count: regCount } = await supabase
                .from('event_registrations')
                .select('*', { count: 'exact', head: true })
                .eq('event_id', event.id);
            
            return {
                ...event,
                regCount: regCount || 0
            };
        }));

        // Build HTML string for horizontal layout
        let eventsHTML = '';
        eventsWithRegistrations.forEach(event => {
            const eventDate = new Date(event.event_date);
            const day = eventDate.getDate();
            const month = eventDate.toLocaleDateString('en-US', { month: 'long' });
            const year = eventDate.getFullYear();
            const time = eventDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
            
            eventsHTML += `
                <div class="event-card bg-white hover-lift w-full mb-6">
                    <div class="flex">
                        <div class="event-date text-white p-6 text-center w-24 flex flex-col justify-center">
                            <div class="text-3xl font-bold">${day}</div>
                            <div class="text-sm">${month}</div>
                            <div class="text-sm">${year}</div>
                        </div>
                        <div class="flex-1 p-6">
                            <div class="flex justify-between items-start mb-2">
                                <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium" data-bn="à¦†à¦¸à¦¨à§à¦¨" data-en="Upcoming">Upcoming</span>
                                <span class="text-gray-500 text-sm"><i class="far fa-clock mr-1"></i>${time}</span>
                            </div>
                            <h3 class="text-xl font-bold text-primary mb-3">${event.title}</h3>
                            <p class="text-gray-600 mb-4">${event.description}</p>
                            <div class="flex items-center text-gray-500 mb-4">
                                <i class="fas fa-map-marker-alt mr-2 text-accent"></i>
                                <span>${event.venue}</span>
                            </div>
                            ${currentUser ? `
                            <button class="register-event-btn bg-accent hover:bg-orange-600 text-white font-medium py-2 px-6 rounded-lg transition btn-icon" data-event-id="${event.id}">
                                <i class="fas fa-user-plus"></i>
                                <span data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦° à¦•à¦°à§à¦¨" data-en="Register">Register</span>
                            </button>
                            ` : `
                            <button class="bg-gray-400 text-white font-medium py-2 px-6 rounded-lg cursor-not-allowed btn-icon">
                                <i class="fas fa-sign-in-alt"></i>
                                <span data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦° à¦•à¦°à¦¤à§‡ à¦²à¦—à¦‡à¦¨ à¦•à¦°à§à¦¨" data-en="Login to Register">Login to Register</span>
                            </button>
                            `}
                            <div class="mt-2 text-sm text-gray-500">
                                <i class="fas fa-users mr-1"></i>
                                <span data-bn="à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨: " data-en="Registrations: ">Registrations: </span>
                                <span id="event-reg-count-${event.id}">${event.regCount}</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        });

        // Set the HTML once
        container.innerHTML = eventsHTML;

        switchLanguage(currentLanguage);

        // Add event listeners for registration buttons
        document.querySelectorAll('.register-event-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                const eventId = this.getAttribute('data-event-id');
                registerForEvent(eventId);
            });
        });

    } catch (error) {
        loading.classList.add('hidden');
        container.innerHTML = `
            <div class="text-center py-8 col-span-2">
                <p class="text-gray-600" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦²à§‹à¦¡ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡" data-en="Error loading events">Error loading events</p>
            </div>
        `;
        switchLanguage(currentLanguage);
    }
}
        // ===== MEMBERS SYSTEM =====
        async function loadMembers() {
            const container = document.getElementById('members-grid');
            const loading = document.getElementById('members-loading');

            try {
                const from = (currentMembersPage - 1) * membersPerPage;
                const to = from + membersPerPage - 1;

                // Get members that are marked to show in site
                const { data: members, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('show_in_site', true)
                    .order('full_name', { ascending: true })
                    .range(from, to);

                if (error) throw error;

                loading.classList.add('hidden');

                // If it's the first page, clear the container
                if (currentMembersPage === 1) {
                    container.innerHTML = '';
                }

                if (members.length === 0 && currentMembersPage === 1) {
                    container.innerHTML = `
                        <div class="text-center py-8 col-span-3">
                            <p class="text-gray-600" data-bn="à¦•à§‹à¦¨ à¦¸à¦¦à¦¸à§à¦¯ à¦ªà¦¾à¦“à¦¯à¦¼à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿" data-en="No members found">No members found</p>
                        </div>
                    `;
                    switchLanguage(currentLanguage);
                  
                    return;
                }

                const membersHTML = members.map(member => `
                    <div class="member-card bg-white p-6 text-center">
                     ${member.profile_picture_url ? 
    `<img src="${member.profile_picture_url}" alt="${member.full_name}" class="w-24 h-24 rounded-full object-cover mx-auto mb-4 border-4 border-secondary">` :
                            `<div class="w-24 h-24 bg-secondary rounded-full flex items-center justify-center mx-auto mb-4 text-white text-3xl font-bold border-4 border-secondary">
                                ${member.full_name ? member.full_name.charAt(0).toUpperCase() : 'U'}
                            </div>`
                        }
                        <h3 class="text-lg font-bold text-primary mb-2">${member.full_name || 'Unknown'}</h3>
                        <p class="text-gray-600 mb-2 flex items-center justify-center">
                            <i class="fas fa-graduation-cap mr-2 text-accent"></i>
                            ${member.batch || 'Not specified'}
                        </p>
                        <p class="text-gray-700 font-medium mb-2 flex items-center justify-center">
                            <i class="fas fa-briefcase mr-2 text-primary"></i>
                            ${member.profession || 'Not specified'}
                        </p>
                        <p class="text-gray-500 text-sm mb-4 flex items-center justify-center">
                            <i class="fas fa-map-marker-alt mr-2 text-secondary"></i>
                            ${member.address || 'Not specified'}
                        </p>
                        <div class="flex justify-center space-x-3 mb-4">
                            ${member.facebook ? `<a href="${member.facebook}" target="_blank" class="text-blue-600 hover:text-blue-800"><i class="fab fa-facebook text-lg"></i></a>` : ''}
                            ${member.linkedin ? `<a href="${member.linkedin}" target="_blank" class="text-blue-700 hover:text-blue-900"><i class="fab fa-linkedin text-lg"></i></a>` : ''}
                            ${member.whatsapp ? `<a href="https://wa.me/${member.whatsapp}" target="_blank" class="text-green-500 hover:text-green-700"><i class="fab fa-whatsapp text-lg"></i></a>` : ''}
                        </div>
                        <button class="view-member-btn bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition w-full btn-icon" data-member-id="${member.id}">
                            <i class="fas fa-eye"></i>
                            <span data-bn="à¦¬à¦¿à¦¸à§à¦¤à¦¾à¦°à¦¿à¦¤ à¦¦à§‡à¦–à§à¦¨" data-en="View Details">View Details</span>
                        </button>
                    </div>
                `).join('');

                container.innerHTML += membersHTML;

                switchLanguage(currentLanguage);

                // Add click event listeners to member buttons
                document.querySelectorAll('.view-member-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const memberId = this.getAttribute('data-member-id');
                        showMemberDetails(memberId);
                    });
                });

                // Hide view more button if no more members
                if (members.length < membersPerPage) {
                    document.getElementById('view-more-members').style.display = 'none';
                }

            } catch (error) {
                loading.classList.add('hidden');
                container.innerHTML = `
                    <div class="text-center py-8 col-span-3">
                        <p class="text-gray-600" data-bn="à¦¸à¦¦à¦¸à§à¦¯ à¦²à§‹à¦¡ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡" data-en="Error loading members">Error loading members</p>
                    </div>
                `;
                switchLanguage(currentLanguage);
            }
        }

        async function showMemberDetails(memberId) {
            try {
                const { data: member, error } = await supabase
                    .from('profiles')
                    .select('*')
                    .eq('id', memberId)
                    .single();

                if (error) throw error;

                const modalContent = document.getElementById('member-modal-content');
                modalContent.innerHTML = `
                    <div class="flex flex-col md:flex-row gap-8">
                        <div class="flex flex-col items-center text-center md:w-1/3">
                            ${member.profile_picture_url ? 
                                `<img src="${member.profile_picture_url}" alt="${member.full_name}" class="member-modal-image mb-4">` :
                                `<div class="member-modal-image bg-secondary flex items-center justify-center text-white text-4xl font-bold mb-4">
                                    ${member.full_name ? member.full_name.charAt(0).toUpperCase() : 'U'}
                                </div>`
                            }
                            <h3 class="text-2xl font-bold text-primary">${member.full_name}</h3>
                            <p class="text-gray-600">${member.profession}</p>
                            <div class="flex space-x-4 mt-4">
                                ${member.facebook ? `<a href="${member.facebook}" target="_blank" class="text-blue-600 hover:text-blue-800"><i class="fab fa-facebook text-2xl"></i></a>` : ''}
                                ${member.linkedin ? `<a href="${member.linkedin}" target="_blank" class="text-blue-700 hover:text-blue-900"><i class="fab fa-linkedin text-2xl"></i></a>` : ''}
                                ${member.whatsapp ? `<a href="https://wa.me/${member.whatsapp}" target="_blank" class="text-green-500 hover:text-green-700"><i class="fab fa-whatsapp text-2xl"></i></a>` : ''}
                            </div>
                        </div>
                        
                        <div class="flex-1 space-y-6 md:w-2/3">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-bold text-primary mb-2" data-bn="à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Personal Information">Personal Information</h4>
                                    <div class="space-y-2">
                                        <p><span class="font-medium">Email:</span> ${member.email}</p>
                                        <p><span class="font-medium">Phone:</span> ${member.phone || 'N/A'}</p>
                                        <p><span class="font-medium">Address:</span> ${member.address || 'N/A'}</p>
                                        <p><span class="font-medium">Date of Birth:</span> ${member.date_of_birth || 'N/A'}</p>
                                        <p><span class="font-medium">Gender:</span> ${member.gender || 'N/A'}</p>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-lg">
                                    <h4 class="font-bold text-primary mb-2" data-bn="à¦¶à¦¿à¦•à§à¦·à¦¾à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Academic Information">Academic Information</h4>
                                    <div class="space-y-2">
                                        <p><span class="font-medium">Batch:</span> ${member.batch || 'N/A'}</p>
                                        <p><span class="font-medium">Passing Year:</span> ${member.passing_year || 'N/A'}</p>
                                        <p><span class="font-medium">Student ID:</span> ${member.student_id || 'N/A'}</p>
                                        <p><span class="font-medium">Department:</span> ${member.department || 'N/A'}</p>
                                    </div>
                                </div>
                                
                                <div class="bg-gray-50 p-4 rounded-lg md:col-span-2">
                                    <h4 class="font-bold text-primary mb-2" data-bn="à¦ªà§‡à¦¶à¦¾à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Professional Information">Professional Information</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <p><span class="font-medium">Profession:</span> ${member.profession || 'N/A'}</p>
                                        <p><span class="font-medium">Company:</span> ${member.company || 'N/A'}</p>
                                        <p><span class="font-medium">Designation:</span> ${member.designation || 'N/A'}</p>
                                        <p><span class="font-medium">Work Location:</span> ${member.work_location || 'N/A'}</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;

                switchLanguage(currentLanguage);
                showModal('member-modal');

            } catch (error) {
                showNotification('Error loading member details', 'error');
            }
        }

        async function registerForEvent(eventId) {
            if (!currentUser) {
                showNotification('Please login to register for events', 'error');
                showModal('login-modal');
                return;
            }

            try {
                // Check if user already registered for this event
                const { data: existingRegistration, error: checkError } = await supabase
                    .from('event_registrations')
                    .select('*')
                    .eq('event_id', eventId)
                    .eq('user_id', userProfile.id)
                    .single();

                // If we get data, user is already registered
                if (existingRegistration) {
                    showNotification('You are already registered for this event', 'info');
                    return;
                }

                // If checkError exists but it's not "no rows" error, throw it
                if (checkError && checkError.code !== 'PGRST116') {
                    throw checkError;
                }

                const { data, error } = await supabase
                    .from('event_registrations')
                    .insert([{
                        event_id: eventId,
                        user_id: userProfile.id, // This now references auth.users.id
                        status: 'pending',
                        created_at: new Date().toISOString()
                    }]);

                if (error) throw error;

                showNotification('Successfully registered for the event! You will receive confirmation soon.', 'success');

                // Update registration count
                const { count } = await supabase
                    .from('event_registrations')
                    .select('*', { count: 'exact', head: true })
                    .eq('event_id', eventId);
                
                const countElement = document.getElementById(`event-reg-count-${eventId}`);
                if (countElement) {
                    countElement.textContent = count;
                }

            } catch (error) {
                console.error('Registration error:', error);
                showNotification('Error registering for event: ' + error.message, 'error');
            }
        }

        function filterMembers(searchTerm) {
            const members = document.querySelectorAll('.member-card');
            const term = searchTerm.toLowerCase();

            members.forEach(member => {
                const name = member.querySelector('h3').textContent.toLowerCase();
                const profession = member.querySelector('p.text-gray-700').textContent.toLowerCase();
                const batch = member.querySelector('p.text-gray-600').textContent.toLowerCase();

                if (name.includes(term) || profession.includes(term) || batch.includes(term)) {
                    member.style.display = 'block';
                } else {
                    member.style.display = 'none';
                }
            });
        }

        function filterByBatch(batch) {
            const members = document.querySelectorAll('.member-card');

            members.forEach(member => {
                const memberBatch = member.querySelector('p.text-gray-600').textContent;
                
                if (batch === 'all') {
                    member.style.display = 'block';
                } else if (batch === '20' && memberBatch.includes('20')) {
                    member.style.display = 'block';
                } else if (batch === '22' && memberBatch.includes('22')) {
                    member.style.display = 'block';
                } else {
                    member.style.display = 'none';
                }
            });
        }

        // ===== GALLERY SYSTEM =====
        async function loadGalleryButtons() {
            const buttonsContainer = document.getElementById('gallery-buttons');
            
            try {
                const { data: galleries, error } = await supabase
                    .from('galleries')
                    .select('*')
                    .order('updated_at', { ascending: false });

                if (error) throw error;

                // Clear existing buttons
                buttonsContainer.innerHTML = '';

                // Add gallery buttons
                galleries.forEach((gallery, index) => {
                    const button = document.createElement('button');
                    button.className = 'event-gallery-button';
                    if (index === 0) {
                        button.classList.add('active');
                        currentGalleryId = gallery.id;
                    }
                    button.setAttribute('data-gallery-id', gallery.id);
                    button.textContent = gallery.name;
                    button.addEventListener('click', function() {
                        // Remove active class from all buttons
                        document.querySelectorAll('.event-gallery-button').forEach(btn => {
                            btn.classList.remove('active');
                        });
                        // Add active class to clicked button
                        this.classList.add('active');
                        const galleryId = this.getAttribute('data-gallery-id');
                        currentGalleryId = galleryId;
                        loadGallery(galleryId);
                    });
                    buttonsContainer.appendChild(button);
                });

                // Load gallery for the first gallery by default
                if (galleries.length > 0) {
                    loadGallery(galleries[0].id);
                } else {
                    document.getElementById('gallery-loading').classList.add('hidden');
                    document.getElementById('no-gallery-message').classList.remove('hidden');
                }

            } catch (error) {
                console.error('Error loading gallery buttons:', error);
                document.getElementById('gallery-loading').classList.add('hidden');
                document.getElementById('no-gallery-message').classList.remove('hidden');
            }
        }

        async function loadGallery(galleryId) {
            const container = document.getElementById('gallery-container');
            const loading = document.getElementById('gallery-loading');
            const noGalleryMessage = document.getElementById('no-gallery-message');
            const viewAllContainer = document.getElementById('view-all-container');
            
            // Show loading state
            container.innerHTML = '';
            loading.classList.remove('hidden');
            noGalleryMessage.classList.add('hidden');
            viewAllContainer.classList.add('hidden');

            try {
                const { data: images, error } = await supabase
                    .from('gallery_images')
                    .select('*')
                    .eq('gallery_id', galleryId)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                loading.classList.add('hidden');

                if (!images || images.length === 0) {
                    noGalleryMessage.classList.remove('hidden');
                    return;
                }

                // Store images for gallery modal
                currentGalleryImages = images;

                // Display first 9 images in grid
                const displayImages = images.slice(0, 9);
               container.innerHTML = displayImages.map((image, index) => `
    <div class="gallery-item" data-index="${index}">
        <img src="${image.image_url}" alt="Gallery Image ${index + 1}">
    </div>
`).join('');

                // Show view all button if there are more than 9 images
                if (images.length > 9) {
                    viewAllContainer.classList.remove('hidden');
                }

                // Add click event to gallery items
                document.querySelectorAll('.gallery-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const index = parseInt(this.getAttribute('data-index'));
                        openGalleryModal(index);
                    });
                });

            } catch (error) {
                loading.classList.add('hidden');
                noGalleryMessage.classList.remove('hidden');
                console.error('Error loading gallery:', error);
            }
        }

        function openGalleryModal(index) {
            currentGalleryIndex = index;
            const image = currentGalleryImages[index];
            const modalImage = document.getElementById('gallery-modal-image');
            const counter = document.querySelector('.gallery-counter');
            
            modalImage.src = image.image_url;
            counter.textContent = `${index + 1} / ${currentGalleryImages.length}`;
            
            showModal('gallery-modal');
        }

        function navigateGallery(direction) {
            currentGalleryIndex += direction;
            
            // Loop around if at the beginning or end
            if (currentGalleryIndex < 0) {
                currentGalleryIndex = currentGalleryImages.length - 1;
            } else if (currentGalleryIndex >= currentGalleryImages.length) {
                currentGalleryIndex = 0;
            }
            
            openGalleryModal(currentGalleryIndex);
        }

        // ===== DASHBOARD SYSTEM =====
        function loadDashboardContent() {
            const dashboardContent = document.getElementById('dashboard-content');
            dashboardContent.innerHTML = `
                <div class="min-h-screen bg-gray-50">
                    <div class="dashboard-nav text-white py-4 shadow-lg">
                        <div class="container mx-auto px-4">
                            <div class="dashboard-header">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                                        <i class="fas fa-graduation-cap text-primary text-xl"></i>
                                    </div>
                                    <div>
                                        <h1 class="text-xl font-bold" data-bn="à¦ªà§à¦°à¦¾à¦•à§à¦¤à¦¨ à¦¶à¦¿à¦•à§à¦·à¦¾à¦°à§à¦¥à§€ à¦¡à§à¦¯à¦¾à¦¶à¦¬à§‹à¦°à§à¦¡" data-en="Alumni Dashboard">Alumni Dashboard</h1>
                                        <p class="text-xs opacity-80">${userProfile?.full_name || currentUser.email}</p>
                                    </div>
                                </div>
                                <button id="back-to-site" class="bg-accent hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition btn-icon">
                                    <i class="fas fa-arrow-left"></i>
                                    <span class="btn-text" data-bn="à¦¸à¦¾à¦‡à¦Ÿà§‡ à¦«à¦¿à¦°à§‡ à¦¯à¦¾à¦¨" data-en="Back to Site">Back to Site</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white shadow-md">
                        <div class="container mx-auto px-4">
                            <div class="dashboard-tabs">
                                <button class="dashboard-tab active-dashboard-tab" data-tab="profile" data-bn="à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦²" data-en="Profile">
                                    <i class="fas fa-user"></i>
                                    <span class="btn-text">Profile</span>
                                </button>
                                <button class="dashboard-tab text-gray-700 hover:text-primary" data-tab="events" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Events">
                                    <i class="fas fa-calendar-alt"></i>
                                    <span class="btn-text">Events</span>
                                </button>
                                <button class="dashboard-tab text-gray-700 hover:text-primary" data-tab="settings" data-bn="à¦¸à§‡à¦Ÿà¦¿à¦‚à¦¸" data-en="Settings">
                                    <i class="fas fa-cog"></i>
                                    <span class="btn-text">Settings</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="container mx-auto px-4 py-8">
                        <div id="profile-tab" class="dashboard-tab-content">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="text-2xl font-bold text-primary" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦²" data-en="Your Profile">Your Profile</h2>
                                </div>
                                <div class="card-body">
                                    <div class="flex justify-between items-center mb-6">
                                        <div></div>
                                        <button id="edit-profile-btn" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦à¦¡à¦¿à¦Ÿ à¦•à¦°à§à¦¨" data-en="Edit Profile">
                                            <i class="fas fa-edit"></i>
                                            <span class="btn-text">Edit Profile</span>
                                        </button>
                                    </div>
                                    <div id="profile-view-content">
                                        <div class="flex flex-col md:flex-row gap-8 items-start">
                                            <div class="flex flex-col items-center">
                                                ${userProfile?.profile_picture_url ? 
                                                    `<img src="${userProfile.profile_picture_url}" alt="${userProfile.full_name}" class="profile-image mb-4">` :
                                                    `<div class="profile-image bg-secondary flex items-center justify-center text-white text-4xl font-bold mb-4">
                                                        ${userProfile?.full_name ? userProfile.full_name.charAt(0).toUpperCase() : 'U'}
                                                    </div>`
                                                }
                                                <button id="change-photo-btn" class="text-primary hover:text-green-800 text-sm mt-2" data-bn="à¦›à¦¬à¦¿ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨" data-en="Change Photo">Change Photo</button>
                                            </div>
                                            
                                            <div class="flex-1 grid grid-cols-1 md:grid-cols-2 gap-6">
                                                <div class="space-y-4">
                                                    <h3 class="text-lg font-bold text-primary" data-bn="à¦¬à§à¦¯à¦•à§à¦¤à¦¿à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Personal Information">Personal Information</h3>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Full Name:</span>
                                                        <p>${userProfile?.full_name || 'N/A'}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Email:</span>
                                                        <p>${currentUser.email}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Phone:</span>
                                                        <p>${userProfile?.phone || 'N/A'}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Date of Birth:</span>
                                                        <p>${userProfile?.date_of_birth ? new Date(userProfile.date_of_birth).toLocaleDateString() : 'N/A'}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Address:</span>
                                                        <p>${userProfile?.address || 'N/A'}</p>
                                                    </div>
                                                </div>
                                                
                                                <div class="space-y-4">
                                                    <h3 class="text-lg font-bold text-primary" data-bn="à¦¶à¦¿à¦•à§à¦·à¦¾à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Academic Information">Academic Information</h3>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Batch:</span>
                                                        <p>${userProfile?.batch || 'N/A'}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Passing Year:</span>
                                                        <p>${userProfile?.passing_year || 'N/A'}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Student ID:</span>
                                                        <p>${userProfile?.student_id || 'N/A'}</p>
                                                    </div>
                                                    <div>
                                                        <span class="font-medium text-gray-700">Department:</span>
                                                        <p>${userProfile?.department || 'N/A'}</p>
                                                    </div>
                                                </div>
                                                
                                                <div class="space-y-4 md:col-span-2">
                                                    <h3 class="text-lg font-bold text-primary" data-bn="à¦ªà§‡à¦¶à¦¾à¦—à¦¤ à¦¤à¦¥à§à¦¯" data-en="Professional Information">Professional Information</h3>
                                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                                        <div>
                                                            <span class="font-medium text-gray-700">Profession:</span>
                                                            <p>${userProfile?.profession || 'N/A'}</p>
                                                        </div>
                                                        <div>
                                                            <span class="font-medium text-gray-700">Company:</span>
                                                            <p>${userProfile?.company || 'N/A'}</p>
                                                        </div>
                                                        <div>
                                                            <span class="font-medium text-gray-700">Designation:</span>
                                                            <p>${userProfile?.designation || 'N/A'}</p>
                                                        </div>
                                                        <div>
                                                            <span class="font-medium text-gray-700">Work Location:</span>
                                                            <p>${userProfile?.work_location || 'N/A'}</p>
                                                        </div>
                                                    </div>
                                                </div>
                                                
                                                ${(userProfile?.facebook || userProfile?.linkedin || userProfile?.whatsapp) ? `
                                                <div class="space-y-4 md:col-span-2">
                                                    <h3 class="text-lg font-bold text-primary">Social Media</h3>
                                                    <div class="flex space-x-4">
                                                        ${userProfile?.facebook ? `<a href="${userProfile.facebook}" target="_blank" class="text-blue-600 hover:text-blue-800"><i class="fab fa-facebook text-2xl"></i></a>` : ''}
                                                        ${userProfile?.linkedin ? `<a href="${userProfile.linkedin}" target="_blank" class="text-blue-700 hover:text-blue-900"><i class="fab fa-linkedin text-2xl"></i></a>` : ''}
                                                        ${userProfile?.whatsapp ? `<a href="https://wa.me/${userProfile.whatsapp}" target="_blank" class="text-green-500 hover:text-green-700"><i class="fab fa-whatsapp text-2xl"></i></a>` : ''}
                                                    </div>
                                                </div>
                                                ` : ''}
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div id="profile-edit-content" class="hidden">
                                        <form id="profile-edit-form" class="space-y-6">
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Full Name</label>
                                                    <input type="text" id="profile-full-name" name="full_name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.full_name || ''}" required>
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Phone</label>
                                                    <input type="tel" id="profile-phone" name="phone" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.phone || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Date of Birth</label>
                                                    <input type="date" id="profile-dob" name="date_of_birth" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.date_of_birth || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Gender</label>
                                                    <select id="profile-gender" name="gender" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                                        <option value="male" ${userProfile?.gender === 'male' ? 'selected' : ''}>Male</option>
                                                        <option value="female" ${userProfile?.gender === 'female' ? 'selected' : ''}>Female</option>
                                                        <option value="other" ${userProfile?.gender === 'other' ? 'selected' : ''}>Other</option>
                                                    </select>
                                                </div>
                                                <div class="md:col-span-2">
                                                    <label class="block text-gray-700 mb-2">Address</label>
                                                    <input type="text" id="profile-address" name="address" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.address || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Batch</label>
                                                    <input type="text" id="profile-batch" name="batch" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.batch || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Passing Year</label>
                                                    <input type="number" id="profile-passing-year" name="passing_year" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.passing_year || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Student ID</label>
                                                    <input type="text" id="profile-student-id" name="student_id" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.student_id || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Department</label>
                                                    <input type="text" id="profile-department" name="department" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.department || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Profession</label>
                                                    <input type="text" id="profile-profession" name="profession" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.profession || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Company</label>
                                                    <input type="text" id="profile-company" name="company" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.company || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Designation</label>
                                                    <input type="text" id="profile-designation" name="designation" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.designation || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Work Location</label>
                                                    <input type="text" id="profile-work-location" name="work_location" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.work_location || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">Facebook</label>
                                                    <input type="url" id="profile-facebook" name="facebook" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.facebook || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">LinkedIn</label>
                                                    <input type="url" id="profile-linkedin" name="linkedin" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.linkedin || ''}">
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2">WhatsApp</label>
                                                    <input type="tel" id="profile-whatsapp" name="whatsapp" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" value="${userProfile?.whatsapp || ''}">
                                                </div>
                                            </div>
                                            <div class="form-actions">
                                                <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦†à¦ªà¦¡à§‡à¦Ÿ à¦•à¦°à§à¦¨" data-en="Update Profile">
                                                    <i class="fas fa-save"></i>
                                                    <span>Update Profile</span>
                                                </button>
                                                <button type="button" id="cancel-edit-btn" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à§à¦¨" data-en="Cancel">
                                                    <i class="fas fa-times"></i>
                                                    <span>Cancel</span>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="events-tab" class="dashboard-tab-content hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="text-2xl font-bold text-primary mb-6" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Your Events">Your Events</h2>
                                </div>
                                <div class="card-body">
                                    <div id="user-events-content">
                                        <div class="text-center py-8">
                                            <div class="loading mx-auto mb-4"></div>
                                            <p class="text-gray-600" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦²à§‹à¦¡ à¦¹à¦šà§à¦›à§‡..." data-en="Loading events...">Loading events...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="settings-tab" class="dashboard-tab-content hidden">
                            <div class="card">
                                <div class="card-header">
                                    <h2 class="text-2xl font-bold text-primary mb-6" data-bn="à¦¸à§‡à¦Ÿà¦¿à¦‚à¦¸" data-en="Settings">Settings</h2>
                                </div>
                                <div class="card-body">
                                    <div class="space-y-8">
                                        <div>
                                            <h3 class="text-xl font-bold text-primary mb-4" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨" data-en="Change Password">Change Password</h3>
                                            <form id="change-password-form" class="space-y-4 max-w-md">
                                                <div>
                                                    <label class="block text-gray-700 mb-2" data-bn="à¦¬à¦°à§à¦¤à¦®à¦¾à¦¨ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡" data-en="Current Password">Current Password</label>
                                                    <input type="password" name="current_password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2" data-bn="à¦¨à¦¤à§à¦¨ à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡" data-en="New Password">New Password</label>
                                                    <input type="password" name="new_password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                                </div>
                                                <div>
                                                    <label class="block text-gray-700 mb-2" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦¨à¦¿à¦¶à§à¦šà¦¿à¦¤ à¦•à¦°à§à¦¨" data-en="Confirm Password">Confirm Password</label>
                                                    <input type="password" name="confirm_password" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                                </div>
                                                <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦ªà¦¾à¦¸à¦“à¦¯à¦¼à¦¾à¦°à§à¦¡ à¦ªà¦°à¦¿à¦¬à¦°à§à¦¤à¦¨ à¦•à¦°à§à¦¨" data-en="Change Password">
                                                    <i class="fas fa-key"></i>
                                                    <span>Change Password</span>
                                                </button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            switchLanguage(currentLanguage);

            document.getElementById('back-to-site').addEventListener('click', showMainSite);
            
            document.querySelectorAll('.dashboard-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    switchDashboardTab(tabName);
                });
            });

            setupDashboardEventListeners();
        }

        function setupDashboardEventListeners() {
            const editProfileBtn = document.getElementById('edit-profile-btn');
            if (editProfileBtn) {
                editProfileBtn.addEventListener('click', function() {
                    // Reload profile data into form fields
                    if (userProfile) {
                        document.getElementById('profile-full-name').value = userProfile.full_name || '';
                        document.getElementById('profile-phone').value = userProfile.phone || '';
                        document.getElementById('profile-dob').value = userProfile.date_of_birth || '';
                        document.getElementById('profile-gender').value = userProfile.gender || 'male';
                        document.getElementById('profile-address').value = userProfile.address || '';
                        document.getElementById('profile-batch').value = userProfile.batch || '';
                        document.getElementById('profile-passing-year').value = userProfile.passing_year || '';
                        document.getElementById('profile-student-id').value = userProfile.student_id || '';
                        document.getElementById('profile-department').value = userProfile.department || '';
                        document.getElementById('profile-profession').value = userProfile.profession || '';
                        document.getElementById('profile-company').value = userProfile.company || '';
                        document.getElementById('profile-designation').value = userProfile.designation || '';
                        document.getElementById('profile-work-location').value = userProfile.work_location || '';
                        document.getElementById('profile-facebook').value = userProfile.facebook || '';
                        document.getElementById('profile-linkedin').value = userProfile.linkedin || '';
                        document.getElementById('profile-whatsapp').value = userProfile.whatsapp || '';
                    }
                    
                    document.getElementById('profile-view-content').classList.add('hidden');
                    document.getElementById('profile-edit-content').classList.remove('hidden');
                });
            }

            const cancelEditBtn = document.getElementById('cancel-edit-btn');
            if (cancelEditBtn) {
                cancelEditBtn.addEventListener('click', function() {
                    document.getElementById('profile-view-content').classList.remove('hidden');
                    document.getElementById('profile-edit-content').classList.add('hidden');
                });
            }

            setupFormListener('profile-edit-form', updateProfile);
            setupFormListener('change-password-form', changePassword);

            loadUserEvents();
        }

        async function updateProfile(e) {
    e.preventDefault();
    const formData = new FormData(document.getElementById('profile-edit-form'));
    const updates = {};

    for (let [key, value] of formData.entries()) {
        if (value) updates[key] = value;
    }

    // Handle profile picture update if needed
    const profilePictureInput = document.getElementById('profile-picture');
    if (profilePictureInput && profilePictureInput.files[0]) {
        try {
            const file = profilePictureInput.files[0];
            const resizedBlob = await resizeImage(file, 400, 400, 0.7);
            const resizedFile = new File([resizedBlob], `profile-${currentUser.id}.webp`, {
                type: 'image/webp'
            });
            
            const fileName = `${currentUser.id}.webp`;
            const filePath = `profile-pictures/${fileName}`;

            // Upload new picture
            const { error: uploadError } = await supabase.storage
                .from('profile-pictures')
                .upload(filePath, resizedFile, { upsert: true });

            if (!uploadError) {
                const { data: urlData } = supabase.storage
                    .from('profile-pictures')
                    .getPublicUrl(filePath);
                
                updates.profile_picture_url = urlData.publicUrl;
                updates.profile_picture_filename = fileName; // âœ… STORE FILENAME
            }
        } catch (error) {
            console.error('Error updating profile picture:', error);
        }
    }

    try {
        const { data, error } = await supabase
            .from('profiles')
            .update(updates)
            .eq('id', currentUser.id);

        if (error) throw error;

        await loadUserProfile();
        // ... rest of the function
    } catch (error) {
        showNotification('Error updating profile: ' + error.message, 'error');
    }
}
        async function changePassword(e) {
            const formData = new FormData(document.getElementById('change-password-form'));
            const currentPassword = formData.get('current_password');
            const newPassword = formData.get('new_password');
            const confirmPassword = formData.get('confirm_password');

            if (newPassword !== confirmPassword) {
                showNotification('New passwords do not match', 'error');
                return;
            }

            try {
                const { data, error } = await supabase.auth.updateUser({
                    password: newPassword
                });

                if (error) throw error;

                document.getElementById('change-password-form').reset();
                showNotification('Password changed successfully!', 'success');

            } catch (error) {
                showNotification('Error changing password: ' + error.message, 'error');
            }
        }

        async function loadUserEvents() {
            const container = document.getElementById('user-events-content');

            try {
                const { data: registrations, error } = await supabase
                    .from('event_registrations')
                    .select(`
                        *,
                        events (*)
                    `)
                    .eq('user_id', userProfile.id)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (registrations.length === 0) {
                    container.innerHTML = `
                        <p class="text-gray-600 text-center py-8" data-bn="à¦†à¦ªà¦¨à¦¿ à¦à¦–à¦¨à§‹ à¦•à§‹à¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿà§‡ à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà¦¾à¦° à¦•à¦°à§‡à¦¨à¦¨à¦¿" data-en="You haven't registered for any events yet">You haven't registered for any events yet</p>
                    `;
                    switchLanguage(currentLanguage);
                    return;
                }

                container.innerHTML = registrations.map(registration => {
                    const eventDate = new Date(registration.events.event_date);
                    const day = eventDate.getDate();
                    const month = eventDate.toLocaleDateString('en-US', { month: 'long' });
                    const year = eventDate.getFullYear();
                    const time = eventDate.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
                    
                    return `
                        <div class="event-card bg-white mb-6">
                            <div class="flex">
                                <div class="event-date text-white p-6 text-center w-24 flex flex-col justify-center">
                                    <div class="text-2xl font-bold">${day}</div>
                                    <div class="text-xs">${month}</div>
                                    <div class="text-xs">${year}</div>
                                </div>
                                <div class="flex-1 p-6">
                                    <div class="flex justify-between items-start mb-2">
                                        <h3 class="text-xl font-bold text-primary">${registration.events.title}</h3>
                                        <span class="px-3 py-1 rounded-full text-sm font-medium status-${registration.status}">${registration.status}</span>
                                    </div>
                                    <p class="text-gray-600 mb-4">${registration.events.description}</p>
                                    <div class="flex items-center text-gray-500 mb-4">
                                        <i class="fas fa-map-marker-alt mr-2 text-accent"></i>
                                        <span>${registration.events.venue}</span>
                                        <i class="far fa-clock ml-4 mr-2 text-primary"></i>
                                        <span>${time}</span>
                                    </div>
                                    ${registration.status === 'confirmed' ? `
                                        <button class="download-ticket-btn bg-accent hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition btn-icon" data-registration-id="${registration.id}">
                                            <i class="fas fa-download"></i>
                                            <span data-bn="à¦Ÿà¦¿à¦•à§‡à¦Ÿ à¦¡à¦¾à¦‰à¦¨à¦²à§‹à¦¡" data-en="Download Ticket">Download Ticket</span>
                                        </button>
                                    ` : ''}
                                    ${registration.status === 'rejected' ? `
                                        <p class="text-red-600 text-sm" data-bn="à¦†à¦ªà¦¨à¦¾à¦° à¦°à§‡à¦œà¦¿à¦¸à§à¦Ÿà§à¦°à§‡à¦¶à¦¨ à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡" data-en="Your registration has been rejected">Your registration has been rejected</p>
                                    ` : ''}
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');

                switchLanguage(currentLanguage);

                document.querySelectorAll('.download-ticket-btn').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const registrationId = this.getAttribute('data-registration-id');
                        downloadTicket(registrationId);
                    });
                });

            } catch (error) {
                container.innerHTML = `
                    <p class="text-gray-600 text-center py-8" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦²à§‹à¦¡ à¦•à¦°à¦¤à§‡ à¦¸à¦®à¦¸à§à¦¯à¦¾ à¦¹à¦¯à¦¼à§‡à¦›à§‡" data-en="Error loading events">Error loading events</p>
                `;
                switchLanguage(currentLanguage);
            }
        }

      async function downloadTicket(registrationId) {
    try {
        // 1. Get registration with event info only
        const { data: registration, error } = await supabase
            .from('event_registrations')
            .select(`
                *,
                events (*)
            `)
            .eq('id', registrationId)
            .single();

        if (error) throw error;

        // 2. Get user profile separately using user_id from registration
        const { data: profile, error: profileError } = await supabase
            .from('profiles')
            .select('full_name, batch, email, phone')
            .eq('id', registration.user_id)  // Use the user_id from registration
            .single();

        if (profileError) throw profileError;

        // 3. Combine data manually for the ticket
        const ticketData = {
            ...registration,
            profiles: profile  // Add profile data manually
        };

        // Generate PDF ticket
        await generateProfessionalTicket(ticketData);

    } catch (error) {
        showNotification('Error downloading ticket: ' + error.message, 'error');
    }
}

        async function generateProfessionalTicket(registration) {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF({
                orientation: 'landscape',
                unit: 'mm',
                format: [100, 210] // Ticket size (height, width)
            });
            
            const event = registration.events;
           const user = registration.profiles || { 
    full_name: 'User', 
    batch: 'N/A', 
    email: 'N/A', 
    phone: 'N/A' 
};
            const eventDate = new Date(event.event_date);
            
            // Page dimensions
            const pageWidth = doc.internal.pageSize.getWidth();
            const pageHeight = doc.internal.pageSize.getHeight();
            
            // Colors
            const primaryColor = [44, 95, 45];
            const accentColor = [230, 126, 34];
            const darkGray = [50, 50, 50];
            
            // Background gradient effect with rectangles
            doc.setFillColor(240, 247, 244);
            doc.rect(0, 0, pageWidth, pageHeight, 'F');
            
            // Left sidebar - Main ticket section (70% width)
            const sidebarWidth = pageWidth * 0.70;
            
            // Decorative top bar
            doc.setFillColor(...primaryColor);
            doc.rect(0, 0, sidebarWidth, 8, 'F');
            
            // Accent stripe
            doc.setFillColor(...accentColor);
            doc.rect(0, 8, sidebarWidth, 2, 'F');
            
            // Main content area
            let yPos = 18;
            const leftMargin = 8;
            
            // Organization name (small header)
            doc.setFontSize(7);
            doc.setTextColor(100, 100, 100);
            doc.setFont("helvetica", "normal");
            doc.text('DSKMAA PRESENTS', leftMargin, yPos);
            yPos += 8;
            
            // Event title
            doc.setFontSize(16);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(...primaryColor);
            const titleLines = doc.splitTextToSize(event.title.toUpperCase(), sidebarWidth - 16);
            doc.text(titleLines, leftMargin, yPos);
            yPos += titleLines.length * 6 + 5;
            
            // Date and time section
            doc.setFillColor(255, 255, 255);
            doc.roundedRect(leftMargin, yPos, sidebarWidth - 16, 18, 2, 2, 'F');
            doc.setDrawColor(220, 220, 220);
            doc.roundedRect(leftMargin, yPos, sidebarWidth - 16, 18, 2, 2, 'S');
            
            // Date icon (simple square)
            doc.setFillColor(...accentColor);
            doc.rect(leftMargin + 3, yPos + 3, 12, 12, 'F');
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(9);
            doc.setFont("helvetica", "bold");
            const day = eventDate.getDate();
            doc.text(day.toString(), leftMargin + 9, yPos + 11, { align: 'center' });
            
            // Date and time text
            doc.setTextColor(...darkGray);
            doc.setFontSize(9);
            doc.setFont("helvetica", "bold");
            doc.text(eventDate.toLocaleDateString('en-US', { 
                weekday: 'short',
                month: 'short', 
                day: 'numeric',
                year: 'numeric'
            }).toUpperCase(), leftMargin + 18, yPos + 7);
            
            doc.setFontSize(8);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(100, 100, 100);
            doc.text(eventDate.toLocaleTimeString('en-US', { 
                hour: '2-digit', 
                minute: '2-digit',
                hour12: true
            }), leftMargin + 18, yPos + 13);
            
            yPos += 23;
            
            // Venue
            doc.setFontSize(8);
            doc.setTextColor(100, 100, 100);
            doc.setFont("helvetica", "normal");
            doc.text('VENUE', leftMargin, yPos);
            yPos += 4;
            
            doc.setFontSize(10);
            doc.setTextColor(...darkGray);
            doc.setFont("helvetica", "bold");
            const venueLines = doc.splitTextToSize(event.venue, sidebarWidth - 16);
            doc.text(venueLines, leftMargin, yPos);
            yPos += venueLines.length * 5 + 8;
            
            // Attendee info
            doc.setFontSize(7);
            doc.setTextColor(100, 100, 100);
            doc.setFont("helvetica", "normal");
            doc.text('TICKET HOLDER', leftMargin, yPos);
            yPos += 4;
            
            doc.setFontSize(11);
            doc.setFont("helvetica", "bold");
            doc.setTextColor(...primaryColor);
            doc.text(user.full_name || 'N/A', leftMargin, yPos);
            yPos += 5;
            
            doc.setFontSize(8);
            doc.setFont("helvetica", "normal");
            doc.setTextColor(...darkGray);
            doc.text(`${user.batch || 'N/A'} â€¢ ${user.email}`, leftMargin, yPos);
            
            // Footer note
            yPos = pageHeight - 12;
            doc.setFontSize(6);
            doc.setTextColor(120, 120, 120);
            doc.text('Please bring valid photo ID â€¢ Non-transferable', leftMargin, yPos);
            yPos += 3;
            doc.text('Contact: alumni.dskmaa2025@gmail.com', leftMargin, yPos);
            
            // Right sidebar - Tear-off stub
            const stubX = sidebarWidth;
            const stubWidth = pageWidth - sidebarWidth;
            
            // Stub background
            doc.setFillColor(...primaryColor);
            doc.rect(stubX, 0, stubWidth, pageHeight, 'F');
            
            // Perforated line effect
            doc.setDrawColor(255, 255, 255);
            doc.setLineWidth(0.5);
            doc.setLineDash([2, 2]);
            doc.line(stubX, 0, stubX, pageHeight);
            doc.setLineDash([]);
            
            // Rotated text on stub
            const stubCenterX = stubX + (stubWidth / 2);
            const stubCenterY = pageHeight / 2;
            
            // Event title (rotated)
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(9);
            doc.setFont("helvetica", "bold");
            
            // Save the transformation state
            doc.saveGraphicsState();
            
            // Rotate text 90 degrees
            const angle = 90;
            doc.text(event.title.toUpperCase(), stubCenterX - 2, stubCenterY, {
                align: 'center',
                angle: angle
            });
            
            // Ticket number (rotated)
            doc.setFontSize(7);
            doc.setFont("helvetica", "normal");
            doc.text(`#${registration.id}`, stubCenterX + 5, stubCenterY, {
                align: 'center',
                angle: angle
            });
            
            // Restore graphics state
            doc.restoreGraphicsState();
            
            // Decorative elements on stub
            doc.setFillColor(...accentColor);
            doc.circle(stubCenterX, 15, 3, 'F');
            doc.circle(stubCenterX, pageHeight - 15, 3, 'F');
            
            // Border around entire ticket
            doc.setDrawColor(...primaryColor);
            doc.setLineWidth(0.5);
            doc.rect(0, 0, pageWidth, pageHeight, 'S');
            
            // Save the PDF
            const fileName = `ticket-${event.title.toLowerCase().replace(/\s+/g, '-')}.pdf`;
            doc.save(fileName);
            
            showNotification('Ticket downloaded successfully!', 'success');
        }

        function switchDashboardTab(tabName) {
            document.querySelectorAll('.dashboard-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            document.getElementById(`${tabName}-tab`).classList.remove('hidden');
            
            document.querySelectorAll('.dashboard-tab').forEach(tab => {
                tab.classList.remove('active-dashboard-tab');
            });
            
            document.querySelector(`.dashboard-tab[data-tab="${tabName}"]`).classList.add('active-dashboard-tab');
        }

        // ===== ADMIN PANEL SYSTEM =====
        function loadAdminPanelContent() {
            const adminPanelContent = document.getElementById('admin-panel-content');
            adminPanelContent.innerHTML = `
                <div class="min-h-screen bg-gray-50">
                    <div class="dashboard-nav text-white py-4 shadow-lg">
                        <div class="container mx-auto px-4">
                            <div class="dashboard-header">
                                <div class="flex items-center space-x-3">
                                    <div class="w-10 h-10 bg-white rounded-full flex items-center justify-center">
                                        <i class="fas fa-cogs text-primary text-xl"></i>
                                    </div>
                                    <div>
                                        <h1 class="text-xl font-bold" data-bn="à¦…à§à¦¯à¦¾à¦¡à¦®à¦¿à¦¨ à¦ªà§à¦¯à¦¾à¦¨à§‡à¦²" data-en="Admin Panel">Admin Panel</h1>
                                    </div>
                                </div>
                                <button id="back-to-site-from-admin" class="bg-accent hover:bg-orange-600 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦¸à¦¾à¦‡à¦Ÿà§‡ à¦«à¦¿à¦°à§‡ à¦¯à¦¾à¦¨" data-en="Back to Site">
                                    <i class="fas fa-arrow-left"></i>
                                    <span class="btn-text">Back to Site</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="container mx-auto px-4 py-8">
                        <div class="admin-grid mb-8">
                            <div class="admin-card cursor-pointer" onclick="showAdminTab('announcements')">
                                <div class="admin-card-header">
                                    <div class="admin-card-title">
                                        <i class="fas fa-bullhorn mr-2"></i>
                                        <span data-bn="à¦˜à§‹à¦·à¦£à¦¾" data-en="Announcements">Announcements</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <p class="text-gray-600" data-bn="à¦¸à¦¾à¦‡à¦Ÿ à¦˜à§‹à¦·à¦£à¦¾ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾ à¦•à¦°à§à¦¨" data-en="Manage site announcements">Manage site announcements</p>
                            </div>
                            
                            <div class="admin-card cursor-pointer" onclick="showAdminTab('events')">
                                <div class="admin-card-header">
                                    <div class="admin-card-title">
                                        <i class="fas fa-calendar-alt mr-2"></i>
                                        <span data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸" data-en="Events">Events</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <p class="text-gray-600" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿà¦¸ à¦à¦¬à¦‚ à¦ªà§à¦¨à¦°à§à¦®à¦¿à¦²à¦¨à§€ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾ à¦•à¦°à§à¦¨" data-en="Manage events and reunions">Manage events and reunions</p>
                            </div>
                            
                            <div class="admin-card cursor-pointer" onclick="showAdminTab('members')">
                                <div class="admin-card-header">
                                    <div class="admin-card-title">
                                        <i class="fas fa-users mr-2"></i>
                                        <span data-bn="à¦¸à¦¦à¦¸à§à¦¯" data-en="Members">Members</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <p class="text-gray-600" data-bn="à¦¸à¦¦à¦¸à§à¦¯ à¦ªà§à¦°à§‹à¦«à¦¾à¦‡à¦² à¦à¦¬à¦‚ à¦…à¦¨à§à¦®à§‹à¦¦à¦¨ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾ à¦•à¦°à§à¦¨" data-en="Manage member profiles and approvals">Manage member profiles and approvals</p>
                            </div>
                            
                            <div class="admin-card cursor-pointer" onclick="showAdminTab('messages')">
                                <div class="admin-card-header">
                                    <div class="admin-card-title">
                                        <i class="fas fa-envelope mr-2"></i>
                                        <span data-bn="à¦¬à¦¾à¦°à§à¦¤à¦¾" data-en="Messages">Messages</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <p class="text-gray-600" data-bn="à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦«à¦°à§à¦® à¦¬à¦¾à¦°à§à¦¤à¦¾ à¦¦à§‡à¦–à§à¦¨ à¦à¦¬à¦‚ à¦‰à¦¤à§à¦¤à¦° à¦¦à¦¿à¦¨" data-en="View and respond to contact form messages">View and respond to contact form messages</p>
                            </div>
                            
                            <div class="admin-card cursor-pointer" onclick="showAdminTab('gallery')">
                                <div class="admin-card-header">
                                    <div class="admin-card-title">
                                        <i class="fas fa-images mr-2"></i>
                                        <span data-bn="à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿" data-en="Gallery">Gallery</span>
                                    </div>
                                    <i class="fas fa-chevron-right text-gray-400"></i>
                                </div>
                                <p class="text-gray-600" data-bn="à¦«à¦Ÿà§‹ à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿ à¦à¦¬à¦‚ à¦‡à¦­à§‡à¦¨à§à¦Ÿ à¦›à¦¬à¦¿ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾ à¦•à¦°à§à¦¨" data-en="Manage photo galleries and event pictures">Manage photo galleries and event pictures</p>
                            </div>
                        </div>

                        <div id="admin-announcements-tab" class="admin-tab-content">
                            <div class="admin-card">
                                <div class="admin-card-header">
                                    <h2 class="admin-card-title" data-bn="à¦˜à§‹à¦·à¦£à¦¾ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾" data-en="Announcements Management">Announcements Management</h2>
                                    <button onclick="showCreateAnnouncementForm()" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦¨à¦¤à§à¦¨ à¦˜à§‹à¦·à¦£à¦¾" data-en="New Announcement">
                                        <i class="fas fa-plus"></i>
                                        <span class="btn-text">New Announcement</span>
                                    </button>
                                </div>
                                
                                <div id="announcements-list">
                                    <div class="text-center py-8">
                                        <div class="loading mx-auto mb-4"></div>
                                        <p class="text-gray-600">Loading announcements...</p>
                                    </div>
                                </div>
                                
                                <div id="create-announcement-form" class="hidden">
                                    <form id="new-announcement-form" class="space-y-4">
                                        <div>
                                            <label class="block text-gray-700 mb-2">Title</label>
                                            <input type="text" name="title" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                        </div>
                                        <div>
                                            <label class="block text-gray-700 mb-2">Content</label>
                                            <textarea name="content" rows="5" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                                        </div>
                                        <div class="form-actions">
                                            <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦˜à§‹à¦·à¦£à¦¾ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§à¦¨" data-en="Create Announcement">
                                                <i class="fas fa-save"></i>
                                                <span>Create Announcement</span>
                                            </button>
                                            <button type="button" onclick="hideCreateAnnouncementForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à§à¦¨" data-en="Cancel">
                                                <i class="fas fa-times"></i>
                                                <span>Cancel</span>
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div id="admin-events-tab" class="admin-tab-content hidden">
                            <div class="admin-card">
                                <div class="admin-card-header">
                                    <h2 class="admin-card-title" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾" data-en="Events Management">Events Management</h2>
                                    <button onclick="showCreateEventForm()" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦¨à¦¤à§à¦¨ à¦‡à¦­à§‡à¦¨à§à¦Ÿ" data-en="New Event">
                                        <i class="fas fa-plus"></i>
                                        <span class="btn-text">New Event</span>
                                    </button>
                                </div>
                                
                                <div id="events-list">
                                    <div class="text-center py-8">
                                        <div class="loading mx-auto mb-4"></div>
                                        <p class="text-gray-600">Loading events...</p>
                                    </div>
                                </div>
                                
                                <div id="create-event-form" class="hidden">
                                    <form id="new-event-form" class="space-y-4">
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <label class="block text-gray-700 mb-2">Title</label>
                                                <input type="text" name="title" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                            </div>
                                            <div>
                                                <label class="block text-gray-700 mb-2">Event Date & Time</label>
                                                <input type="datetime-local" name="event_date" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                            </div>
                                        </div>
                                        <div>
                                            <label class="block text-gray-700 mb-2">Description</label>
                                            <textarea name="description" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                                        </div>
                                        <div>
                                            <label class="block text-gray-700 mb-2">Venue</label>
                                            <input type="text" name="venue" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                        </div>
                                        <div class="flex items-center space-x-4">
                                            <input type="checkbox" id="registration-active" name="registration_active" class="w-4 h-4" checked>
                                            <label for="registration-active" class="text-gray-700">Registration Active</label>
                                        </div>
                                        <div class="form-actions">
                                            <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦‡à¦­à§‡à¦¨à§à¦Ÿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§à¦¨" data-en="Create Event">
                                                <i class="fas fa-save"></i>
                                                <span>Create Event</span>
                                            </button>
                                            <button type="button" onclick="hideCreateEventForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à§à¦¨" data-en="Cancel">
                                                <i class="fas fa-times"></i>
                                                <span>Cancel</span>
                                            </button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>

                        <div id="admin-members-tab" class="admin-tab-content hidden">
                            <div class="admin-card">
                                <h2 class="admin-card-title mb-6" data-bn="à¦¸à¦¦à¦¸à§à¦¯ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾" data-en="Members Management">Members Management</h2>
                                
                                <div class="mb-6 flex flex-wrap gap-4">
                                    <input type="text" id="admin-member-search" placeholder="Search members..." class="w-full md:w-1/3 px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                                    <div class="flex gap-2">
                                        <button class="batch-filter-admin-btn bg-primary text-white px-4 py-2 rounded-lg active" data-batch="all">All</button>
                                        <button class="batch-filter-admin-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg" data-batch="20">20 Batch</button>
                                        <button class="batch-filter-admin-btn bg-gray-200 text-gray-700 px-4 py-2 rounded-lg" data-batch="22">22 Batch</button>
                                    </div>
                                </div>
                                
                                <div id="members-list">
                                    <div class="text-center py-8">
                                        <div class="loading mx-auto mb-4"></div>
                                        <p class="text-gray-600">Loading members...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="admin-messages-tab" class="admin-tab-content hidden">
                            <div class="admin-card">
                                <h2 class="admin-card-title mb-6" data-bn="à¦¯à§‹à¦—à¦¾à¦¯à§‹à¦— à¦¬à¦¾à¦°à§à¦¤à¦¾" data-en="Contact Messages">Contact Messages</h2>
                                
                                <div id="messages-list">
                                    <div class="text-center py-8">
                                        <div class="loading mx-auto mb-4"></div>
                                        <p class="text-gray-600">Loading messages...</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div id="admin-gallery-tab" class="admin-tab-content hidden">
                            <div class="admin-card">
                                <div class="admin-card-header">
                                    <h2 class="admin-card-title" data-bn="à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿ à¦¬à§à¦¯à¦¬à¦¸à§à¦¥à¦¾à¦ªà¦¨à¦¾" data-en="Gallery Management">Gallery Management</h2>
                                    <button onclick="showCreateGalleryForm()" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦¨à¦¤à§à¦¨ à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿" data-en="New Gallery">
                                        <i class="fas fa-plus"></i>
                                        <span class="btn-text">New Gallery</span>
                                    </button>
                                </div>
                                
                                <div id="galleries-list">
                                    <div class="text-center py-8">
                                        <div class="loading mx-auto mb-4"></div>
                                        <p class="text-gray-600">Loading galleries...</p>
                                    </div>
                                </div>
                                
                                <div id="create-gallery-form" class="hidden">
                                    <form id="new-gallery-form" class="space-y-4">
                                        <div>
                                            <label class="block text-gray-700 mb-2">Gallery Name</label>
                                            <input type="text" name="name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                        </div>
                                        <div>
                                            <label class="block text-gray-700 mb-2">Description</label>
                                            <textarea name="description" rows="3" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary"></textarea>
                                        </div>
                                        <div class="form-actions">
                                            <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦—à§à¦¯à¦¾à¦²à¦¾à¦°à¦¿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§à¦¨" data-en="Create Gallery">
                                                <i class="fas fa-save"></i>
                                                <span>Create Gallery</span>
                                            </button>
                                            <button type="button" onclick="hideCreateGalleryForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à§à¦¨" data-en="Cancel">
                                                <i class="fas fa-times"></i>
                                                <span>Cancel</span>
                                            </button>
                                        </div>
                                    </form>
                                </div>
                                
                                <div id="gallery-management-content" class="hidden">
                                    <div class="gallery-management-header">
                                        <h3 class="text-xl font-bold text-primary" id="gallery-management-title">Gallery Management</h3>
                                        <div class="flex gap-2">
                                            <button onclick="showUploadGalleryForm()" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon" data-bn="à¦›à¦¬à¦¿ à¦†à¦ªà¦²à§‹à¦¡" data-en="Upload Images">
                                                <i class="fas fa-upload"></i>
                                                <span class="btn-text">Upload Images</span>
                                            </button>
                                            <button onclick="backToGalleries()" class="back-btn">
                                                <i class="fas fa-arrow-left"></i>
                                                <span class="btn-text">Back</span>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div id="gallery-images-list">
                                        <div class="text-center py-8">
                                            <p class="text-gray-600">Select a gallery to manage its images</p>
                                        </div>
                                    </div>
                                    
                                    <div id="upload-gallery-form" class="hidden">
                                        <form id="new-gallery-upload-form" class="space-y-4">
                                            <div>
                                                <label class="block text-gray-700 mb-2">Images</label>
                                               <input type="file" name="gallery_images" multiple accept="image/*" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required>
                                            </div>
                                            <div class="form-actions">
                                                <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦›à¦¬à¦¿ à¦†à¦ªà¦²à§‹à¦¡ à¦•à¦°à§à¦¨" data-en="Upload Images">
                                                    <i class="fas fa-upload"></i>
                                                    <span>Upload Images</span>
                                                </button>
                                                <button type="button" onclick="hideUploadGalleryForm()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition btn-icon" data-bn="à¦¬à¦¾à¦¤à¦¿à¦² à¦•à¦°à§à¦¨" data-en="Cancel">
                                                    <i class="fas fa-times"></i>
                                                    <span>Cancel</span>
                                                </button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;

            switchLanguage(currentLanguage);

            document.getElementById('back-to-site-from-admin').addEventListener('click', showMainSite);
            
            // Load initial admin data
            loadAdminAnnouncements();
            
            // Add event listeners for admin member batch filtering
            document.querySelectorAll('.batch-filter-admin-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    const batch = this.getAttribute('data-batch');
                    filterAdminMembersByBatch(batch);
                    
                    document.querySelectorAll('.batch-filter-admin-btn').forEach(b => {
                        b.classList.remove('active', 'bg-primary', 'text-white');
                        b.classList.add('bg-gray-200', 'text-gray-700');
                    });
                    this.classList.remove('bg-gray-200', 'text-gray-700');
                    this.classList.add('active', 'bg-primary', 'text-white');
                });
            });
        }

        // Global functions for admin panel
        window.showAdminTab = function(tabName) {
            document.querySelectorAll('.admin-tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            document.getElementById(`admin-${tabName}-tab`).classList.remove('hidden');

            // Load tab content
            if (tabName === 'announcements') {
                loadAdminAnnouncements();
            } else if (tabName === 'events') {
                loadAdminEvents();
            } else if (tabName === 'members') {
                loadAdminMembers();
            } else if (tabName === 'messages') {
                loadAdminMessages();
            } else if (tabName === 'gallery') {
                loadAdminGalleries();
            }
        };

        window.showCreateAnnouncementForm = function() {
            document.getElementById('announcements-list').classList.add('hidden');
            document.getElementById('create-announcement-form').classList.remove('hidden');
        };

        window.hideCreateAnnouncementForm = function() {
            document.getElementById('announcements-list').classList.remove('hidden');
            document.getElementById('create-announcement-form').classList.add('hidden');
        };

        window.showCreateEventForm = function() {
            document.getElementById('events-list').classList.add('hidden');
            document.getElementById('create-event-form').classList.remove('hidden');
            
            // Ensure form listener is attached
            setupFormListener('new-event-form', createEvent);
            
            // Reset form and button state
            const form = document.getElementById('new-event-form');
            if (form) {
                form.reset();
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn) {
                    submitBtn.innerHTML = '<i class="fas fa-save"></i><span>Create Event</span>';
                    submitBtn.removeAttribute('data-event-id');
                }
            }
        };

        window.hideCreateEventForm = function() {
            document.getElementById('events-list').classList.remove('hidden');
            document.getElementById('create-event-form').classList.add('hidden');
        };

        window.showCreateGalleryForm = function() {
            document.getElementById('galleries-list').classList.add('hidden');
            document.getElementById('create-gallery-form').classList.remove('hidden');
        };

        window.hideCreateGalleryForm = function() {
            document.getElementById('galleries-list').classList.remove('hidden');
            document.getElementById('create-gallery-form').classList.add('hidden');
        };

        window.showUploadGalleryForm = function() {
            document.getElementById('gallery-images-list').classList.add('hidden');
            document.getElementById('upload-gallery-form').classList.remove('hidden');
        };

        window.hideUploadGalleryForm = function() {
            document.getElementById('gallery-images-list').classList.remove('hidden');
            document.getElementById('upload-gallery-form').classList.add('hidden');
        };

        window.backToGalleries = function() {
            document.getElementById('gallery-management-content').classList.add('hidden');
            document.getElementById('galleries-list').classList.remove('hidden');
        };

        async function loadAdminAnnouncements() {
            const container = document.getElementById('announcements-list');
            
            try {
                const { data: announcements, error } = await supabase
                    .from('announcements')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (announcements.length === 0) {
                    container.innerHTML = '<p class="text-gray-600 text-center py-8">No announcements found</p>';
                    return;
                }

                container.innerHTML = `
                    <div class="admin-grid">
                        ${announcements.map(announcement => `
                            <div class="admin-item">
                                <div class="admin-item-header">
                                    <div class="admin-item-title">${announcement.title}</div>
                                    <div class="admin-action-buttons">
                                        <button onclick="editAnnouncement('${announcement.id}')" class="admin-action-btn primary" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button onclick="deleteAnnouncement('${announcement.id}')" class="admin-action-btn danger" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <p class="text-gray-600 text-sm mb-2">${announcement.content.length > 100 ? announcement.content.substring(0, 100) + '...' : announcement.content}</p>
                                <p class="text-gray-500 text-xs">${new Date(announcement.created_at).toLocaleDateString()}</p>
                            </div>
                        `).join('')}
                    </div>
                `;

                // Add event listener for new announcement form
                setupFormListener('new-announcement-form', createAnnouncement);

            } catch (error) {
                container.innerHTML = '<p class="text-gray-600 text-center py-8">Error loading announcements</p>';
            }
        }

        async function createAnnouncement(e) {
            e.preventDefault();
            const form = document.getElementById('new-announcement-form');
            const formData = new FormData(form);
            const title = formData.get('title');
            const content = formData.get('content');

            try {
                const { data, error } = await supabase
                    .from('announcements')
                    .insert([{
                        title: title,
                        content: content
                    }]);

                if (error) throw error;

                showNotification('Announcement created successfully!', 'success');
                hideCreateAnnouncementForm();
                loadAdminAnnouncements();
                loadAnnouncements();

                // Reset the form
                form.reset();

            } catch (error) {
                showNotification('Error creating announcement: ' + error.message, 'error');
            }
        }

        window.editAnnouncement = async function(id) {
            try {
                const { data: announcement, error } = await supabase
                    .from('announcements')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;

                // Show edit form with current data
                document.getElementById('announcements-list').classList.add('hidden');
                document.getElementById('create-announcement-form').classList.remove('hidden');
                
                const form = document.getElementById('new-announcement-form');
                form.querySelector('input[name="title"]').value = announcement.title;
                form.querySelector('textarea[name="content"]').value = announcement.content;
                
                // Change form to update mode
                const submitBtn = form.querySelector('button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save"></i><span>Update Announcement</span>';
                submitBtn.setAttribute('data-announcement-id', id);
                
                // Update form listener for update
                setupFormListener('new-announcement-form', function(e) {
                    e.preventDefault();
                    updateAnnouncement(id);
                });

            } catch (error) {
                showNotification('Error loading announcement: ' + error.message, 'error');
            }
        };

        async function updateAnnouncement(id) {
            const formData = new FormData(document.getElementById('new-announcement-form'));
            const title = formData.get('title');
            const content = formData.get('content');

            try {
                const { data, error } = await supabase
                    .from('announcements')
                    .update({ title, content })
                    .eq('id', id);

                if (error) throw error;

                showNotification('Announcement updated successfully!', 'success');
                hideCreateAnnouncementForm();
                loadAdminAnnouncements();
                loadAnnouncements();

            } catch (error) {
                showNotification('Error updating announcement: ' + error.message, 'error');
            }
        }

        window.deleteAnnouncement = async function(id) {
            try {
                const { data, error } = await supabase
                    .from('announcements')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                showNotification('Announcement deleted successfully!', 'success');
                loadAdminAnnouncements();
                loadAnnouncements();

            } catch (error) {
                showNotification('Error deleting announcement: ' + error.message, 'error');
            }
        };

        async function loadAdminEvents() {
            const container = document.getElementById('events-list');
            
            try {
                const { data: events, error } = await supabase
                    .from('events')
                    .select(`
                        *,
                        event_registrations (id)
                    `)
                    .order('event_date', { ascending: true });

                if (error) throw error;

                if (events.length === 0) {
                    container.innerHTML = '<p class="text-gray-600 text-center py-8">No events found</p>';
                    return;
                }

                container.innerHTML = `
                    <div class="admin-grid">
                        ${events.map(event => {
                            const eventDate = new Date(event.event_date);
                            const regCount = event.event_registrations ? event.event_registrations.length : 0;
                            return `
                                <div class="admin-item">
                                    <div class="admin-item-header">
                                        <div class="admin-item-title">${event.title}</div>
                                        <div class="admin-action-buttons">
                                            <button onclick="toggleEventRegistration('${event.id}', ${!event.registration_active})" class="admin-action-btn ${event.registration_active ? 'danger' : 'success'}" title="${event.registration_active ? 'Stop Registration' : 'Start Registration'}">
                                                <i class="fas ${event.registration_active ? 'fa-pause' : 'fa-play'}"></i>
                                            </button>
                                            <button onclick="viewEventRegistrations('${event.id}')" class="admin-action-btn primary" title="View Registrations">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button onclick="editEvent('${event.id}')" class="admin-action-btn warning" title="Edit">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button onclick="deleteEvent('${event.id}')" class="admin-action-btn danger" title="Delete">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </div>
                                    <p class="text-gray-600 text-sm mb-2">${event.description.length > 100 ? event.description.substring(0, 100) + '...' : event.description}</p>
                                    <div class="flex justify-between text-xs text-gray-500">
                                        <span>${eventDate.toLocaleDateString()}</span>
                                        <span>${event.venue}</span>
                                    </div>
                                    <div class="mt-2">
                                        <span class="px-2 py-1 rounded text-xs ${event.registration_active ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                            ${event.registration_active ? 'Active' : 'Inactive'}
                                        </span>
                                        <span class="ml-2 text-xs text-gray-500">${regCount} registrations</span>
                                    </div>
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;

                // Add event listener for new event form
                setupFormListener('new-event-form', createEvent);

            } catch (error) {
                container.innerHTML = '<p class="text-gray-600 text-center py-8">Error loading events</p>';
            }
        }

        async function createEvent(e) {
            e.preventDefault();
            const form = document.getElementById('new-event-form');
            if (!form) {
                showNotification('Error: Form not found', 'error');
                return;
            }
            
            const formData = new FormData(form);
            const title = formData.get('title');
            const description = formData.get('description');
            const event_date = formData.get('event_date');
            const venue = formData.get('venue');
            const registration_active = document.getElementById('registration-active') ? document.getElementById('registration-active').checked : true;

            // Validate required fields
            if (!title || !description || !event_date || !venue) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            try {
                const eventData = {
                    title: title.trim(),
                    description: description.trim(),
                    event_date: event_date,
                    venue: venue.trim(),
                    registration_active: registration_active
                };

                console.log('Creating event with data:', eventData);

                const { data, error } = await supabase
                    .from('events')
                    .insert([eventData])
                    .select();

                if (error) {
                    console.error('Supabase error:', error);
                    throw error;
                }

                console.log('Event created successfully:', data);
                showNotification('Event created successfully!', 'success');
                hideCreateEventForm();
                loadAdminEvents();
                loadEvents();

                // Reset the form
                form.reset();

            } catch (error) {
                console.error('Error creating event:', error);
                showNotification('Error creating event: ' + (error.message || 'Unknown error'), 'error');
            }
        }

        window.toggleEventRegistration = async function(eventId, activate) {
            try {
                const { data, error } = await supabase
                    .from('events')
                    .update({ registration_active: activate })
                    .eq('id', eventId);

                if (error) throw error;

                showNotification(`Registration ${activate ? 'started' : 'stopped'} successfully!`, 'success');
                loadAdminEvents();
                loadEvents();

            } catch (error) {
                showNotification('Error updating event: ' + error.message, 'error');
            }
        };

  // ===== EVENT REGISTRATIONS MANAGEMENT =====
let currentRegistrationsData = [];
let currentEventData = null;

window.viewEventRegistrations = async function(id) {
    try {
        // STORE EVENT ID FOR LATER USE
        window.currentEventId = id;
        
        // 1. Get event details
        const { data: event, error: eventError } = await supabase
            .from('events')
            .select('*')
            .eq('id', id)
            .single();

        if (eventError) throw eventError;

        // 2. Load pending registrations (DEFAULT VIEW)
        await loadPendingRegistrations(id, event);
        
    } catch (error) {
        showNotification('Error loading event registrations: ' + error.message, 'error');
    }
}

// NEW FUNCTION: Load only pending registrations with search
async function loadPendingRegistrations(eventId, event) {
    try {
        // STORE DATA FOR LATER USE
        currentEventData = event;
        
        // Get ONLY pending registrations
        const { data: registrations, error } = await supabase
            .from('event_registrations')
            .select(`
                *,
                events (title, event_date, venue)
            `)
            .eq('event_id', eventId)
            .eq('status', 'pending');

        if (error) throw error;

        // Get profile data
        const profileIds = registrations.map(reg => reg.user_id);
        const { data: profiles, error: profilesError } = await supabase
            .from('profiles')
            .select('id, full_name, email, batch, phone')
            .in('id', profileIds);

        // STORE THE DATA FOR SEARCH/FILTERING
        currentRegistrationsData = registrations.map(reg => {
            const profile = profiles.find(p => p.id === reg.user_id);
            return {
                ...reg,
                profile: profile || { full_name: 'Unknown', email: 'N/A', batch: 'N/A', phone: 'N/A' }
            };
        });

        // GENERATE MODAL WITH SEARCH + TABS
        const modalContent = document.getElementById('member-modal-content');
        modalContent.innerHTML = `
            <div class="space-y-4">
                <!-- EVENT INFO -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h3 class="text-2xl font-bold text-primary mb-2">${event.title}</h3>
                    <p class="text-gray-600">${event.description}</p>
                    <div class="flex flex-wrap gap-4 mt-2 text-sm text-gray-500">
                        <span><i class="fas fa-map-marker-alt mr-1"></i>${event.venue}</span>
                        <span><i class="far fa-clock mr-1"></i>${new Date(event.event_date).toLocaleString()}</span>
                    </div>
                </div>

                <!-- SEARCH BAR -->
                <div class="relative">
                    <input type="text" id="registration-search" 
                           placeholder="ðŸ” Search by name, batch, email..." 
                           class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary">
                </div>

                <!-- TABS -->
                <div class="flex border-b">
                    <button class="tab-button active py-2 px-4 border-b-2 border-primary text-primary font-medium" 
                            onclick="switchToPendingTab()">
                        Pending (${currentRegistrationsData.length})
                    </button>
                    <button class="tab-button py-2 px-4 text-gray-500 hover:text-primary" 
                            onclick="switchToConfirmedTab()">
                        Confirmed
                    </button>
                </div>

                <!-- REGISTRATIONS LIST -->
                <div id="registrations-list-container">
                    ${generateRegistrationsHTML(currentRegistrationsData)}
                </div>
            </div>
        `;

        // ADD SEARCH FUNCTIONALITY
        document.getElementById('registration-search').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            const filtered = currentRegistrationsData.filter(reg => 
                reg.profile.full_name.toLowerCase().includes(searchTerm) ||
                (reg.profile.batch && reg.profile.batch.toLowerCase().includes(searchTerm)) ||
                reg.profile.email.toLowerCase().includes(searchTerm)
            );
            document.getElementById('registrations-list-container').innerHTML = generateRegistrationsHTML(filtered);
        });

        showModal('member-modal');

    } catch (error) {
        showNotification('Error loading pending registrations: ' + error.message, 'error');
    }
}

// HELPER FUNCTION: Generate HTML for registrations list
function generateRegistrationsHTML(registrations) {
    if (registrations.length === 0) {
        return '<p class="text-gray-600 text-center py-8">No pending registrations found</p>';
    }

    return `
        <div class="space-y-3">
            ${registrations.map(reg => `
                <div class="bg-white border border-gray-200 rounded-lg p-4">
                    <div class="flex justify-between items-start">
                        <div class="flex-1">
                            <h4 class="font-semibold text-gray-800">${reg.profile.full_name}</h4>
                            <p class="text-sm text-gray-600">${reg.profile.batch} â€¢ ${reg.profile.email}</p>
                            <p class="text-sm text-gray-500">${reg.profile.phone || 'No phone'}</p>
                        </div>
                        <div class="flex space-x-2">
                            <button onclick="confirmRegistration('${reg.id}')" 
                                    class="bg-green-500 hover:bg-green-600 text-white px-3 py-1 rounded text-sm">
                                âœ… Confirm
                            </button>
                            <button onclick="removeRegistration('${reg.id}')" 
                                    class="bg-red-500 hover:bg-red-600 text-white px-3 py-1 rounded text-sm">
                                âŒ Remove
                            </button>
                        </div>
                    </div>
                </div>
            `).join('')}
        </div>
    `;
}

// TAB SWITCHING FUNCTIONS
function switchToPendingTab() {
    // Update tab styles
    document.querySelectorAll('.tab-button').forEach(btn => {
        btn.classList.remove('active', 'border-b-2', 'border-primary', 'text-primary');
        btn.classList.add('text-gray-500');
    });
    document.querySelector('.tab-button:first-child').classList.add('active', 'border-b-2', 'border-primary', 'text-primary');
    
    // Show pending registrations
    document.getElementById('registrations-list-container').innerHTML = generateRegistrationsHTML(currentRegistrationsData);
}

async function switchToConfirmedTab() {
    try {
        // Update tab styles
        document.querySelectorAll('.tab-button').forEach(btn => {
            btn.classList.remove('active', 'border-b-2', 'border-primary', 'text-primary');
            btn.classList.add('text-gray-500');
        });
        document.querySelector('.tab-button:last-child').classList.add('active', 'border-b-2', 'border-primary', 'text-primary');

        // Load confirmed registrations
        const { data: confirmedRegistrations, error } = await supabase
            .from('event_registrations')
            .select(`
                *,
                events (title, event_date, venue)
            `)
            .eq('event_id', window.currentEventId)
            .eq('status', 'confirmed');

        if (error) throw error;

        const profileIds = confirmedRegistrations.map(reg => reg.user_id);
        const { data: profiles, error: profilesError } = await supabase
            .from('profiles')
            .select('id, full_name, email, batch, phone')
            .in('id', profileIds);

        const confirmedWithProfiles = confirmedRegistrations.map(reg => {
            const profile = profiles.find(p => p.id === reg.user_id);
            return {
                ...reg,
                profile: profile || { full_name: 'Unknown', email: 'N/A', batch: 'N/A', phone: 'N/A' }
            };
        });

        document.getElementById('registrations-list-container').innerHTML = `
            <div class="space-y-3">
                ${confirmedWithProfiles.map(reg => `
                    <div class="bg-green-50 border border-green-200 rounded-lg p-4">
                        <div class="flex justify-between items-start">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-800">${reg.profile.full_name}</h4>
                                <p class="text-sm text-gray-600">${reg.profile.batch} â€¢ ${reg.profile.email}</p>
                                <p class="text-sm text-gray-500">${reg.profile.phone || 'No phone'}</p>
                            </div>
                            <span class="bg-green-100 text-green-800 px-2 py-1 rounded text-sm">Confirmed</span>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;

    } catch (error) {
        showNotification('Error loading confirmed registrations: ' + error.message, 'error');
    }
}

// UPDATE EXISTING FUNCTIONS FOR REAL-TIME UPDATES
window.confirmRegistration = async function(registrationId) {
    try {
        const { data, error } = await supabase
            .from('event_registrations')
            .update({ status: 'confirmed' })
            .eq('id', registrationId);

        if (error) throw error;

        showNotification('Registration confirmed successfully!', 'success');
        
        // REMOVE FROM CURRENT DATA IMMEDIATELY
        currentRegistrationsData = currentRegistrationsData.filter(reg => reg.id !== registrationId);
        
        // UPDATE THE UI IMMEDIATELY
        document.getElementById('registrations-list-container').innerHTML = generateRegistrationsHTML(currentRegistrationsData);
        
        // UPDATE PENDING COUNTER
        const pendingTab = document.querySelector('.tab-button:first-child');
        pendingTab.textContent = `Pending (${currentRegistrationsData.length})`;

    } catch (error) {
        showNotification('Error confirming registration: ' + error.message, 'error');
    }
}

window.removeRegistration = async function(registrationId) {
    try {
        const { data, error } = await supabase
            .from('event_registrations')
            .delete()
            .eq('id', registrationId);

        if (error) throw error;

        showNotification('Registration removed successfully!', 'success');
        
        // REMOVE FROM CURRENT DATA IMMEDIATELY
        currentRegistrationsData = currentRegistrationsData.filter(reg => reg.id !== registrationId);
        
        // UPDATE THE UI IMMEDIATELY
        document.getElementById('registrations-list-container').innerHTML = generateRegistrationsHTML(currentRegistrationsData);
        
        // UPDATE PENDING COUNTER
        const pendingTab = document.querySelector('.tab-button:first-child');
        pendingTab.textContent = `Pending (${currentRegistrationsData.length})`;

    } catch (error) {
        showNotification('Error removing registration: ' + error.message, 'error');
    }
}

        window.editEvent = async function(id) {
            try {
                const { data: event, error } = await supabase
                    .from('events')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;

                // Show edit form with current data
                document.getElementById('events-list').classList.add('hidden');
                document.getElementById('create-event-form').classList.remove('hidden');
                
                const form = document.getElementById('new-event-form');
                form.querySelector('input[name="title"]').value = event.title;
                form.querySelector('textarea[name="description"]').value = event.description;
                form.querySelector('input[name="venue"]').value = event.venue;
                
                // Format date for datetime-local input
                const eventDate = new Date(event.event_date);
                const formattedDate = eventDate.toISOString().slice(0, 16);
                form.querySelector('input[name="event_date"]').value = formattedDate;
                
                document.getElementById('registration-active').checked = event.registration_active;
                
                // Change form to update mode
                const submitBtn = form.querySelector('button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save"></i><span>Update Event</span>';
                submitBtn.setAttribute('data-event-id', id);
                
                // Update form listener for update
                setupFormListener('new-event-form', function(e) {
                    e.preventDefault();
                    updateEvent(id);
                });

            } catch (error) {
                showNotification('Error loading event: ' + error.message, 'error');
            }
        };

        async function updateEvent(id) {
            const formData = new FormData(document.getElementById('new-event-form'));
            const title = formData.get('title');
            const description = formData.get('description');
            const event_date = formData.get('event_date');
            const venue = formData.get('venue');
            const registration_active = document.getElementById('registration-active').checked;

            try {
                const { data, error } = await supabase
                    .from('events')
                    .update({ title, description, event_date, venue, registration_active })
                    .eq('id', id);

                if (error) throw error;

                showNotification('Event updated successfully!', 'success');
                hideCreateEventForm();
                loadAdminEvents();
                loadEvents();

            } catch (error) {
                showNotification('Error updating event: ' + error.message, 'error');
            }
        }

        window.deleteEvent = async function(id) {
            try {
                const { data, error } = await supabase
                    .from('events')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                showNotification('Event deleted successfully!', 'success');
                loadAdminEvents();
                loadEvents();

            } catch (error) {
                showNotification('Error deleting event: ' + error.message, 'error');
            }
        };

        async function loadAdminMembers() {
    const container = document.getElementById('members-list');
    
    try {
        const { data: members, error } = await supabase
            .from('profiles')
            .select('*')
            .order('full_name', { ascending: true });

        if (error) throw error;

        if (members.length === 0) {
            container.innerHTML = '<p class="text-gray-600 text-center py-8">No members found</p>';
            return;
        }

        container.innerHTML = `
            <div class="admin-grid">
                ${members.map(member => `
                    <div class="admin-item">
                        <div class="admin-item-header">
                            <div class="admin-item-title">${member.full_name || 'Unknown'}</div>
                            <div class="admin-action-buttons">
                                <button onclick="toggleShowInSite('${member.id}', ${!member.show_in_site})" class="admin-action-btn ${member.show_in_site ? 'danger' : 'success'}" title="${member.show_in_site ? 'Hide from Site' : 'Show on Site'}">
                                    <i class="fas ${member.show_in_site ? 'fa-eye' : 'fa-eye-slash'}"></i>
                                </button>
                                <button onclick="viewMemberDetails('${member.id}')" class="admin-action-btn primary" title="View Details">
                                    <i class="fas fa-eye"></i>
                                </button>
                                <button onclick="deleteMember('${member.id}')" class="admin-action-btn danger" title="Delete">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                        <p class="text-gray-600 text-sm mb-2">${member.email}</p>
                        <div class="flex justify-between text-xs text-gray-500">
                            <span>${member.batch || 'N/A'}</span>
                            <span>${member.profession || 'N/A'}</span>
                        </div>
                        <div class="mt-2">
                            <span class="px-2 py-1 rounded text-xs ${member.show_in_site ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'}">
                                ${member.show_in_site ? 'Visible' : 'Hidden'}
                            </span>
                        </div>
                    </div>
                `).join('')}
            </div>
        `;

        // Add search functionality
        const searchInput = document.getElementById('admin-member-search');
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                const term = this.value.toLowerCase();
                const items = container.querySelectorAll('.admin-item');
                
                items.forEach(item => {
                    const name = item.querySelector('.admin-item-title').textContent.toLowerCase();
                    const email = item.querySelector('p.text-gray-600').textContent.toLowerCase();
                    const batch = item.querySelector('span:first-child').textContent.toLowerCase();
                    
                    if (name.includes(term) || email.includes(term) || batch.includes(term)) {
                        item.style.display = 'block';
                    } else {
                        item.style.display = 'none';
                    }
                });
            });
        }

    } catch (error) {
        container.innerHTML = '<p class="text-gray-600 text-center py-8">Error loading members</p>';
    }
}

        function filterAdminMembersByBatch(batch) {
            const container = document.getElementById('members-list');
            const items = container.querySelectorAll('.admin-item');
            
            items.forEach(item => {
                const memberBatch = item.querySelector('span:first-child').textContent;
                
                if (batch === 'all') {
                    item.style.display = 'block';
                } else if (batch === '20' && memberBatch.includes('20')) {
                    item.style.display = 'block';
                } else if (batch === '22' && memberBatch.includes('22')) {
                    item.style.display = 'block';
                } else {
                    item.style.display = 'none';
                }
            });
        }

  window.toggleShowInSite = async function(memberId, newShowInSiteValue) {
    try {
        const { data, error } = await supabase
            .from('profiles')
            .update({ show_in_site: newShowInSiteValue })
            .eq('id', memberId);

        if (error) throw error;

        showNotification(`Member ${newShowInSiteValue ? 'shown' : 'hidden'} on site successfully!`, 'success');
        loadAdminMembers();
        loadMembers();
        loadStats();

    } catch (error) {
        showNotification('Error updating member: ' + error.message, 'error');
    }
};

    window.deleteMember = async function(memberId) {
    try {
        // Get member data
        const { data: member } = await supabase
            .from('profiles')
            .select('profile_picture_filename, profile_picture_url')
            .eq('id', memberId)
            .single();

        console.log('Member data:', member);

        // Delete profile picture from storage
        if (member?.profile_picture_filename) {
            const filePath = `profile-pictures/${member.profile_picture_filename}`;
            console.log('Deleting:', filePath);
            
            await supabase.storage
                .from('profile-pictures')
                .remove([filePath]);
        } else if (member?.profile_picture_url) {
            // Extract filename from URL
            const fileName = member.profile_picture_url.split('/').pop();
            const filePath = `profile-pictures/${fileName}`;
            console.log('Deleting from URL:', filePath);
            
            await supabase.storage
                .from('profile-pictures')
                .remove([filePath]);
        }

        // Delete event registrations
        await supabase.from('event_registrations').delete().eq('user_id', memberId);

        // Delete profile
        await supabase.from('profiles').delete().eq('id', memberId);

        showNotification('Member deleted successfully!', 'success');
        loadAdminMembers();
        loadMembers();
        loadStats();

    } catch (error) {
        console.error('Error:', error);
        showNotification('Error deleting member: ' + error.message, 'error');
    }
};




        async function loadAdminMessages() {
            const container = document.getElementById('messages-list');
            
            try {
                const { data: messages, error } = await supabase
                    .from('contact_messages')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (messages.length === 0) {
                    container.innerHTML = '<p class="text-gray-600 text-center py-8">No messages found</p>';
                    return;
                }

                container.innerHTML = `
                    <div class="admin-grid">
                        ${messages.map(message => `
                            <div class="admin-item">
                                <div class="admin-item-header">
                                    <div class="admin-item-title">${message.name}</div>
                                    <div class="admin-action-buttons">
                                        <button onclick="replyToMessage('${message.id}')" class="admin-action-btn primary" title="Reply">
                                            <i class="fas fa-reply"></i>
                                        </button>
                                        <button onclick="markAsRead('${message.id}')" class="admin-action-btn success" title="Mark as Read">
                                            <i class="fas fa-check"></i>
                                        </button>
                                        <button onclick="deleteMessage('${message.id}')" class="admin-action-btn danger" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <p class="text-gray-600 text-sm mb-2">${message.email}</p>
                                <p class="text-gray-600 text-sm mb-2">${message.message.length > 100 ? message.message.substring(0, 100) + '...' : message.message}</p>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>${message.batch || 'Not specified'}</span>
                                    <span class="px-2 py-1 rounded text-xs bg-${message.status === 'unread' ? 'red' : 'green'}-500 text-white">${message.status}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;

            } catch (error) {
                container.innerHTML = '<p class="text-gray-600 text-center py-8">Error loading messages</p>';
            }
        }

        window.viewMemberDetails = function(id) {
            showMemberDetails(id);
        };

        window.replyToMessage = async function(id) {
            try {
                const { data: message, error } = await supabase
                    .from('contact_messages')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;

                const modalContent = document.getElementById('member-modal-content');
                modalContent.innerHTML = `
                    <div class="space-y-6">
                        <div>
                            <h3 class="text-2xl font-bold text-primary mb-4">Reply to Message</h3>
                            <div class="bg-gray-50 p-4 rounded-lg">
                                <p><strong>From:</strong> ${message.name} (${message.email})</p>
                                <p><strong>Batch:</strong> ${message.batch || 'Not specified'}</p>
                                <p class="mt-2"><strong>Message:</strong></p>
                                <p class="bg-white p-3 rounded mt-2">${message.message}</p>
                            </div>
                        </div>
                        <form id="reply-form" class="space-y-4">
                            <div>
                                <label class="block text-gray-700 mb-2">Reply Message</label>
                                <textarea name="reply" rows="5" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary" required></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="bg-primary hover:bg-green-800 text-white px-6 py-3 rounded-lg transition btn-icon">
                                    <i class="fas fa-paper-plane"></i>
                                    <span>Send Reply</span>
                                </button>
                                <button type="button" onclick="hideAllModals()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-3 rounded-lg transition btn-icon">
                                    <i class="fas fa-times"></i>
                                    <span>Cancel</span>
                                </button>
                            </div>
                        </form>
                    </div>
                `;

                // Add event listener for reply form
                setupFormListener('reply-form', function(e) {
                    e.preventDefault();
                    const formData = new FormData(e.target);
                    const replyText = formData.get('reply');
                    sendReply(id, replyText);
                });

                showModal('member-modal');

            } catch (error) {
                showNotification('Error loading message: ' + error.message, 'error');
            }
        };

        async function sendReply(messageId, replyText) {
            try {
                // In a real application, you would send an email here
                // For demo purposes, we'll just update the message status
                const { data, error } = await supabase
                    .from('contact_messages')
                    .update({ status: 'replied' })
                    .eq('id', messageId);

                if (error) throw error;

                showNotification('Reply sent successfully!', 'success');
                hideAllModals();
                loadAdminMessages();

            } catch (error) {
                showNotification('Error sending reply: ' + error.message, 'error');
            }
        }

        window.markAsRead = async function(id) {
            try {
                const { data, error } = await supabase
                    .from('contact_messages')
                    .update({ status: 'read' })
                    .eq('id', id);

                if (error) throw error;

                showNotification('Message marked as read!', 'success');
                loadAdminMessages();

            } catch (error) {
                showNotification('Error updating message: ' + error.message, 'error');
            }
        };

        window.deleteMessage = async function(id) {
            try {
                const { data, error } = await supabase
                    .from('contact_messages')
                    .delete()
                    .eq('id', id);

                if (error) throw error;

                showNotification('Message deleted successfully!', 'success');
                loadAdminMessages();

            } catch (error) {
                showNotification('Error deleting message: ' + error.message, 'error');
            }
        };

        // Gallery Management Functions
        async function loadAdminGalleries() {
            const container = document.getElementById('galleries-list');
            
            try {
                const { data: galleries, error } = await supabase
                    .from('galleries')
                    .select('*')
                    .order('updated_at', { ascending: false });

                if (error) throw error;

                if (galleries.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-8">
                            <p class="text-gray-600 mb-4">No galleries found</p>
                            <button onclick="showCreateGalleryForm()" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon">
                                <i class="fas fa-plus"></i>
                                <span>Create Gallery</span>
                            </button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = `
                    <div class="admin-grid">
                        ${galleries.map(gallery => `
                            <div class="admin-item">
                                <div class="admin-item-header">
                                    <div class="admin-item-title">${gallery.name}</div>
                                    <div class="admin-action-buttons">
                                        <button onclick="manageGalleryImages('${gallery.id}')" class="admin-action-btn primary" title="Manage Images">
                                            <i class="fas fa-images"></i>
                                        </button>
                                        <button onclick="editGallery('${gallery.id}')" class="admin-action-btn warning" title="Edit">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                        <button onclick="deleteGallery('${gallery.id}')" class="admin-action-btn danger" title="Delete">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </div>
                                <p class="text-gray-600 text-sm mb-2">${gallery.description || 'No description'}</p>
                                <div class="flex justify-between text-xs text-gray-500">
                                    <span>Last updated: ${new Date(gallery.updated_at).toLocaleDateString()}</span>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;

                // Add event listener for new gallery form
                setupFormListener('new-gallery-form', createGallery);

            } catch (error) {
                container.innerHTML = '<p class="text-gray-600 text-center py-8">Error loading galleries</p>';
            }
        }

        async function createGallery(e) {
            e.preventDefault();
            const form = document.getElementById('new-gallery-form');
            const formData = new FormData(form);
            const name = formData.get('name');
            const description = formData.get('description');

            try {
                const { data, error } = await supabase
                    .from('galleries')
                    .insert([{
                        name: name,
                        description: description
                    }]);

                if (error) throw error;

                showNotification('Gallery created successfully!', 'success');
                hideCreateGalleryForm();
                loadAdminGalleries();
                loadGalleryButtons();

                // Reset the form
                form.reset();

            } catch (error) {
                showNotification('Error creating gallery: ' + error.message, 'error');
            }
        }

        window.manageGalleryImages = function(galleryId) {
            currentGalleryId = galleryId;
            document.getElementById('galleries-list').classList.add('hidden');
            document.getElementById('gallery-management-content').classList.remove('hidden');
            document.getElementById('gallery-management-title').textContent = `Manage Images: ${document.querySelector(`[data-gallery-id="${galleryId}"]`).textContent}`;
            loadGalleryImages(galleryId);
        };

        window.editGallery = async function(id) {
            try {
                const { data: gallery, error } = await supabase
                    .from('galleries')
                    .select('*')
                    .eq('id', id)
                    .single();

                if (error) throw error;

                // Show edit form with current data
                document.getElementById('galleries-list').classList.add('hidden');
                document.getElementById('create-gallery-form').classList.remove('hidden');
                
                const form = document.getElementById('new-gallery-form');
                form.querySelector('input[name="name"]').value = gallery.name;
                form.querySelector('textarea[name="description"]').value = gallery.description || '';
                
                // Change form to update mode
                const submitBtn = form.querySelector('button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save"></i><span>Update Gallery</span>';
                submitBtn.setAttribute('data-gallery-id', id);
                
                // Update form listener for update
                setupFormListener('new-gallery-form', function(e) {
                    e.preventDefault();
                    updateGallery(id);
                });

            } catch (error) {
                showNotification('Error loading gallery: ' + error.message, 'error');
            }
        };

        async function updateGallery(id) {
            const formData = new FormData(document.getElementById('new-gallery-form'));
            const name = formData.get('name');
            const description = formData.get('description');

            try {
                const { data, error } = await supabase
                    .from('galleries')
                    .update({ name, description, updated_at: new Date().toISOString() })
                    .eq('id', id);

                if (error) throw error;

                showNotification('Gallery updated successfully!', 'success');
                hideCreateGalleryForm();
                loadAdminGalleries();
                loadGalleryButtons();

            } catch (error) {
                showNotification('Error updating gallery: ' + error.message, 'error');
            }
        }

        window.deleteGallery = async function(id) {
            try {
                // First delete all images in this gallery
                const { error: imagesError } = await supabase
                    .from('gallery_images')
                    .delete()
                    .eq('gallery_id', id);

                if (imagesError) throw imagesError;

                // Then delete the gallery
                const { error: galleryError } = await supabase
                    .from('galleries')
                    .delete()
                    .eq('id', id);

                if (galleryError) throw galleryError;

                showNotification('Gallery deleted successfully!', 'success');
                loadAdminGalleries();
                loadGalleryButtons();

            } catch (error) {
                showNotification('Error deleting gallery: ' + error.message, 'error');
            }
        };

        async function loadGalleryImages(galleryId) {
            const container = document.getElementById('gallery-images-list');
            
            try {
                const { data: images, error } = await supabase
                    .from('gallery_images')
                    .select('*')
                    .eq('gallery_id', galleryId)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                if (!images || images.length === 0) {
                    container.innerHTML = `
                        <div class="text-center py-8">
                            <p class="text-gray-600 mb-4">No images found for this gallery</p>
                            <button onclick="showUploadGalleryForm()" class="bg-primary hover:bg-green-800 text-white px-4 py-2 rounded-lg transition btn-icon">
                                <i class="fas fa-upload"></i>
                                <span>Upload Images</span>
                            </button>
                        </div>
                    `;
                    return;
                }

                container.innerHTML = `
                    <div class="gallery-container">
                        ${images.map((image, index) => `
                            <div class="gallery-item relative">
                                <img src="${image.image_url}" alt="Gallery Image ${index + 1}">
                                <div class="absolute top-2 right-2">
                                    <button onclick="deleteGalleryImage('${image.id}')" class="admin-action-btn danger" title="Delete Image">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                        `).join('')}
                    </div>
                `;

                // Set up form submission for image upload
                setupFormListener('new-gallery-upload-form', uploadGalleryImages);

            } catch (error) {
                container.innerHTML = '<p class="text-gray-600 text-center py-8">Error loading gallery images</p>';
            }
        }

     async function uploadGalleryImages(e) {
    e.preventDefault();
    
    // Check if user is authenticated as admin
    if (!isAdmin) {
        showNotification('Please login as admin to upload images', 'error');
        return;
    }

    const fileInput = document.querySelector('input[name="gallery_images"]');
    const files = fileInput.files;

    if (files.length === 0) {
        showNotification('Please select at least one image', 'error');
        return;
    }

    try {
        const submitBtn = document.querySelector('#new-gallery-upload-form button[type="submit"]');
        const originalText = submitBtn.innerHTML;
        submitBtn.innerHTML = '<div class="loading"></div> Uploading...';
        submitBtn.disabled = true;

        let successfulUploads = 0;
        let failedUploads = 0;

        for (let i = 0; i < files.length; i++) {
            const file = files[i];
            
            if (!file.type.startsWith('image/')) {
                showNotification(`Skipping ${file.name} - not an image file`, 'error');
                failedUploads++;
                continue;
            }

            // Check original size
            if (file.size > 5 * 1024 * 1024) {
                showNotification(`Skipping ${file.name} - file too large (max 5MB)`, 'error');
                failedUploads++;
                continue;
            }

            try {
                 // AUTO-RESIZE: Resize to WebP with 100KB limit
    const resizedBlob = await resizeImage(file, 1200, 1200, 0.6); // Lower quality for gallery
    const resizedFile = new File([resizedBlob], `gallery-${Date.now()}-${i}.webp`, {
        type: 'image/webp'  // Change to WebP
    });

               
                   // Check final size - 100KB limit
    if (resizedFile.size > 100 * 1024) {
                    showNotification(`Skipping ${file.name} - still too large after compression`, 'error');
                    failedUploads++;
                    continue;
                }

                   const fileName = `${Date.now()}-${Math.random().toString(36).substring(2, 15)}.webp`;
                const filePath = `gallery-images/${currentGalleryId}/${fileName}`;

                // Upload to storage (RESIZED FILE)
                const { data: uploadData, error: uploadError } = await supabase.storage
                    .from('gallery-images')
                    .upload(filePath, resizedFile);

                if (uploadError) {
                    console.error('Upload error:', uploadError);
                    
                    if (uploadError.message.includes('row-level security')) {
                        showNotification('Storage permission denied. Please check RLS policies.', 'error');
                    }
                    
                    failedUploads++;
                    continue;
                }

                // Get public URL
                const { data: urlData } = supabase.storage
                    .from('gallery-images')
                    .getPublicUrl(filePath);

                // Add to gallery_images table
                const { error: dbError } = await supabase
                    .from('gallery_images')
                    .insert([{
                        gallery_id: currentGalleryId,
                        image_url: urlData.publicUrl,
                        file_name: fileName,
                        file_size: resizedFile.size, // Store resized file size
                        mime_type: 'image/webp' // Always JPEG after resize
                    }]);

                if (dbError) {
                    console.error('Database error:', dbError);
                    // Try to delete the uploaded file
                    await supabase.storage.from('gallery-images').remove([filePath]);
                    failedUploads++;
                } else {
                    successfulUploads++;
                    console.log(`Uploaded: ${fileName} (${(resizedFile.size / 1024).toFixed(2)}KB)`);
                }

            } catch (fileError) {
                console.error('File processing error:', fileError);
                showNotification(`Error processing ${file.name}`, 'error');
                failedUploads++;
            }
        }

        // Update gallery updated_at timestamp
        if (successfulUploads > 0) {
            await supabase
                .from('galleries')
                .update({ updated_at: new Date().toISOString() })
                .eq('id', currentGalleryId);
        }

        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;

        if (successfulUploads > 0) {
            showNotification(`Successfully uploaded ${successfulUploads} image(s) - auto-resized to optimal size`, 'success');
            hideUploadGalleryForm();
            
            // Reload gallery images
            loadGalleryImages(currentGalleryId);
            
            // Reset the form
            document.getElementById('new-gallery-upload-form').reset();
            
            // Reload gallery buttons on main site
            loadGalleryButtons();
        } else {
            showNotification('Upload failed. No images were processed successfully.', 'error');
        }

    } catch (error) {
        console.error('Upload process error:', error);
        showNotification('Error uploading images', 'error');
        
        const submitBtn = document.querySelector('#new-gallery-upload-form button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-upload"></i><span>Upload Images</span>';
        submitBtn.disabled = false;
    }
}

        window.deleteGalleryImage = async function(imageId) {
            try {
                // Get image details first
                const { data: image, error: fetchError } = await supabase
                    .from('gallery_images')
                    .select('*')
                    .eq('id', imageId)
                    .single();

                if (fetchError) throw fetchError;

                // Delete from storage - extract the correct file path from the URL
                const urlParts = image.image_url.split('/');
                const fileName = urlParts[urlParts.length - 1];
                const filePath = `gallery-images/${image.gallery_id}/${fileName}`;
                
                const { error: storageError } = await supabase.storage
                    .from('gallery-images')
                    .remove([filePath]);

                if (storageError) {
                    console.error('Storage delete error:', storageError);
                    // Continue with database deletion even if storage deletion fails
                }

                // Delete from database
                const { error: dbError } = await supabase
                    .from('gallery_images')
                    .delete()
                    .eq('id', imageId);

                if (dbError) throw dbError;

                // Update gallery updated_at timestamp
                await supabase
                    .from('galleries')
                    .update({ updated_at: new Date().toISOString() })
                    .eq('id', image.gallery_id);

                showNotification('Image deleted successfully!', 'success');
                
                // Reload the gallery images
                loadGalleryImages(currentGalleryId);
                
                // Reload gallery buttons on main site
                loadGalleryButtons();

            } catch (error) {
                console.error('Delete error:', error);
                showNotification('Error deleting image: ' + error.message, 'error');
            }
        };

        // ===== UTILITY FUNCTIONS =====
        async function testGalleryUpload() {
            try {
                console.log('Testing gallery upload...');
                
                // Test if we can list buckets
                const { data: buckets, error: bucketsError } = await supabase.storage.listBuckets();
                if (bucketsError) {
                    console.error('Cannot list buckets:', bucketsError);
                    return false;
                }
                
                console.log('Available buckets:', buckets);
                
                // Check if gallery-images bucket exists
                const galleryBucket = buckets.find(bucket => bucket.name === 'gallery-images');
                if (!galleryBucket) {
                    console.error('gallery-images bucket not found');
                    return false;
                }
                
                console.log('Gallery bucket found:', galleryBucket);
                return true;
                
            } catch (error) {
                console.error('Storage test failed:', error);
                return false;
            }
        }

        // Call this when admin panel loads
        testGalleryUpload();

        // SUPER SIMPLE SCROLL ANIMATION
function initScrollAnimations() {
    const sections = document.querySelectorAll('section');
    
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.classList.add('visible');
            }
        });
    }, { threshold: 0.1 });
    
    sections.forEach(section => observer.observe(section));
}

// Call this in DOMContentLoaded - FIND this line and add one line:
document.addEventListener('DOMContentLoaded', function() {
    initializeApp();
    setupEventListeners();
    loadInitialData();
    initScrollAnimations(); // â† ADD JUST THIS LINE
});


    </script>
</body>
</html>